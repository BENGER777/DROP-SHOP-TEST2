<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>DROP SHOP | –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  :root {
    --admin-primary: #0a0a0a;
    --admin-secondary: #1a1a1a;
    --admin-accent: #FFD700;
    --admin-success: #27ae60;
    --admin-danger: #e74c3c;
    --admin-warning: #f39c12;
    --admin-info: #3498db;
    --admin-light: #f8f9fa;
    --admin-dark: #121212;
    --admin-text: #e0e0e0;
    --admin-text-light: #a0a0a0;
    --admin-profit: #2ecc71;
    --admin-expense: #e74c3c;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--admin-dark);
    color: var(--admin-text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  .login-container {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    background: linear-gradient(135deg, var(--admin-dark) 0%, #2c3e50 100%);
    padding: 2rem;
  }

  .login-box {
    background: var(--admin-secondary);
    padding: 3rem;
    border-radius: 20px;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
    width: 100%;
    max-width: 450px;
    border: 1px solid rgba(255, 215, 0, 0.1);
  }

  .login-header {
    text-align: center;
    margin-bottom: 2.5rem;
  }

  .login-icon {
    font-size: 3rem;
    color: var(--admin-accent);
    margin-bottom: 1rem;
  }

  .login-title {
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
  }

  .login-subtitle {
    color: var(--admin-text-light);
    font-size: 0.9rem;
  }

  .input-group {
    margin-bottom: 1.5rem;
  }

  .input-label {
    display: block;
    margin-bottom: 0.5rem;
    color: var(--admin-text-light);
    font-size: 0.9rem;
    font-weight: 500;
  }

  .input-field {
    width: 100%;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    color: var(--admin-text);
    font-size: 1rem;
    transition: all 0.3s ease;
  }

  .input-field:focus {
    outline: none;
    border-color: var(--admin-accent);
    box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.1);
  }

  .login-btn {
    width: 100%;
    padding: 1rem;
    background: var(--admin-accent);
    color: var(--admin-dark);
    border: none;
    border-radius: 10px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 1rem;
  }

  .login-btn:hover {
    background: #ffed4e;
    transform: translateY(-2px);
  }

  .error-message {
    background: rgba(231, 76, 60, 0.1);
    color: var(--admin-danger);
    padding: 1rem;
    border-radius: 10px;
    margin-top: 1.5rem;
    display: none;
    border: 1px solid rgba(231, 76, 60, 0.3);
  }

  .admin-container {
    display: none;
    min-height: 100vh;
  }

  .admin-header {
    background: var(--admin-primary);
    padding: 1rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid rgba(255, 215, 0, 0.1);
    position: sticky;
    top: 0;
    z-index: 1000;
  }

  .admin-logo {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .admin-logo-icon {
    font-size: 1.8rem;
    color: var(--admin-accent);
  }

  .admin-logo-text {
    font-weight: 700;
    font-size: 1.3rem;
  }

  .admin-actions {
    display: flex;
    gap: 1rem;
    align-items: center;
  }

  .admin-time {
    color: var(--admin-text-light);
    font-size: 0.9rem;
  }

  .logout-btn {
    background: rgba(231, 76, 60, 0.1);
    color: var(--admin-danger);
    border: 1px solid rgba(231, 76, 60, 0.3);
    padding: 0.7rem 1.5rem;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.3s ease;
  }

  .logout-btn:hover {
    background: var(--admin-danger);
    color: white;
  }

  .admin-nav {
    background: var(--admin-secondary);
    padding: 1rem 2rem;
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  }

  .nav-tab {
    padding: 0.8rem 1.5rem;
    background: transparent;
    border: 1px solid transparent;
    color: var(--admin-text-light);
    border-radius: 8px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.3s ease;
    white-space: nowrap;
  }

  .nav-tab:hover {
    background: rgba(255, 255, 255, 0.05);
    color: var(--admin-text);
  }

  .nav-tab.active {
    background: var(--admin-accent);
    color: var(--admin-dark);
    border-color: var(--admin-accent);
  }

  .admin-content {
    padding: 2rem;
    max-width: 1400px;
    margin: 0 auto;
  }

  .tab-content {
    display: none;
    animation: fadeIn 0.3s ease;
  }

  .tab-content.active {
    display: block;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
  .finance-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .finance-card {
    background: var(--admin-secondary);
    padding: 1.5rem;
    border-radius: 15px;
    border: 1px solid rgba(255, 255, 255, 0.05);
    transition: transform 0.3s ease;
  }

  .finance-card:hover {
    transform: translateY(-5px);
    border-color: rgba(255, 215, 0, 0.2);
  }

  .finance-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
  }

  .finance-icon {
    font-size: 1.8rem;
  }

  .finance-value {
    font-size: 2.2rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
  }

  .finance-label {
    color: var(--admin-text-light);
    font-size: 0.9rem;
  }

  .profit-value {
    color: var(--admin-profit);
  }

  .revenue-value {
    color: var(--admin-accent);
  }

  .expenses-value {
    color: var(--admin-expense);
  }

  .margin-value {
    color: var(--admin-info);
  }

  /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤ */
  .order-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
  }

  .stat-badge {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    padding: 1rem;
    background: var(--admin-secondary);
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.05);
  }

  .stat-badge-icon {
    font-size: 1.5rem;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
  }

  .stat-badge-content {
    flex: 1;
  }

  .stat-badge-value {
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 0.2rem;
  }

  .stat-badge-label {
    font-size: 0.8rem;
    color: var(--admin-text-light);
  }

  /* –§–æ—Ä–º—ã */
  .form-container {
    background: var(--admin-secondary);
    padding: 2rem;
    border-radius: 15px;
    border: 1px solid rgba(255, 255, 255, 0.05);
    margin-bottom: 2rem;
  }

  .form-title {
    font-size: 1.5rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    display: flex;
    align-items: center;
    gap: 0.8rem;
  }

  .form-title i {
    color: var(--admin-accent);
  }

  .form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .form-group {
    margin-bottom: 1.5rem;
  }

  .form-label {
    display: block;
    margin-bottom: 0.5rem;
    color: var(--admin-text-light);
    font-size: 0.9rem;
    font-weight: 500;
  }

  .form-control {
    width: 100%;
    padding: 0.9rem;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    color: var(--admin-text);
    font-size: 1rem;
    transition: all 0.3s ease;
  }

  .form-control:focus {
    outline: none;
    border-color: var(--admin-accent);
    box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.1);
  }

  textarea.form-control {
    min-height: 120px;
    resize: vertical;
  }

  .form-select {
    width: 100%;
    padding: 0.9rem;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    color: var(--admin-text);
    font-size: 1rem;
    cursor: pointer;
  }

  .cost-indicator {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0.5rem;
    font-size: 0.9rem;
  }

  .margin-indicator {
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    font-weight: 600;
  }

  .margin-good {
    background: rgba(46, 204, 113, 0.2);
    color: var(--admin-profit);
  }

  .margin-warning {
    background: rgba(241, 196, 15, 0.2);
    color: var(--admin-warning);
  }

  .margin-bad {
    background: rgba(231, 76, 60, 0.2);
    color: var(--admin-danger);
  }

  .image-upload-area {
    border: 2px dashed rgba(255, 215, 0, 0.3);
    border-radius: 10px;
    padding: 2rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 1rem;
  }

  .image-upload-area:hover {
    border-color: var(--admin-accent);
    background: rgba(255, 215, 0, 0.05);
  }

  .image-preview {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
  }

  .preview-image {
    width: 100%;
    height: 120px;
    object-fit: cover;
    border-radius: 8px;
    border: 2px solid transparent;
    transition: all 0.3s ease;
  }

  .preview-image:hover {
    border-color: var(--admin-accent);
    transform: scale(1.05);
  }

  .form-actions {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid rgba(255, 255, 255, 0.05);
  }

  .btn {
    padding: 1rem 2rem;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .btn-primary {
    background: var(--admin-accent);
    color: var(--admin-dark);
    flex: 1;
  }

  .btn-primary:hover {
    background: #ffed4e;
    transform: translateY(-2px);
  }

  .btn-secondary {
    background: rgba(255, 255, 255, 0.05);
    color: var(--admin-text);
  }

  .btn-secondary:hover {
    background: rgba(255, 255, 255, 0.1);
  }

  /* –¢–∞–±–ª–∏—Ü—ã */
  .table-container {
    background: var(--admin-secondary);
    border-radius: 15px;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.05);
  }

  .table-header {
    padding: 1.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .table-title {
    font-size: 1.3rem;
    font-weight: 600;
  }

  .table-filters {
    display: flex;
    gap: 1rem;
  }

  .data-table {
    width: 100%;
    border-collapse: collapse;
  }

  .data-table th {
    background: rgba(255, 255, 255, 0.03);
    padding: 1rem;
    text-align: left;
    font-weight: 600;
    color: var(--admin-text-light);
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  }

  .data-table td {
    padding: 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  }

  .data-table tr:hover {
    background: rgba(255, 255, 255, 0.02);
  }

  /* –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤ */
  .status-badge {
    padding: 0.3rem 0.8rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    display: inline-block;
  }

  .status-new {
    background: rgba(52, 152, 219, 0.1);
    color: var(--admin-info);
  }

  .status-processing {
    background: rgba(241, 196, 15, 0.1);
    color: var(--admin-warning);
  }

  .status-delivery {
    background: rgba(155, 89, 182, 0.1);
    color: #9b59b6;
  }

  .status-completed {
    background: rgba(39, 174, 96, 0.1);
    color: var(--admin-success);
  }

  .status-cancelled {
    background: rgba(231, 76, 60, 0.1);
    color: var(--admin-danger);
  }

  .profit-badge {
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    font-size: 0.8rem;
    font-weight: 600;
  }

  .profit-positive {
    background: rgba(46, 204, 113, 0.2);
    color: var(--admin-profit);
  }

  .profit-negative {
    background: rgba(231, 76, 60, 0.2);
    color: var(--admin-danger);
  }

  .table-actions {
    display: flex;
    gap: 0.5rem;
  }

  .action-btn {
    padding: 0.5rem;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .action-btn.view {
    background: rgba(52, 152, 219, 0.1);
    color: var(--admin-info);
  }

  .action-btn.edit {
    background: rgba(255, 215, 0, 0.1);
    color: var(--admin-accent);
  }

  .action-btn.delete {
    background: rgba(231, 76, 60, 0.1);
    color: var(--admin-danger);
  }

  .action-btn:hover {
    transform: translateY(-2px);
  }

  /* –ì—Ä–∞—Ñ–∏–∫–∏ */
  .charts-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .chart-box {
    background: var(--admin-secondary);
    padding: 1.5rem;
    border-radius: 15px;
    border: 1px solid rgba(255, 255, 255, 0.05);
  }

  .chart-title {
    margin-bottom: 1rem;
    font-size: 1.2rem;
    font-weight: 600;
  }

  .chart-canvas {
    width: 100%;
    height: 300px;
  }

  /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
  .notification-admin {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 1rem 1.5rem;
    background: var(--admin-success);
    color: white;
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    z-index: 10000;
    display: flex;
    align-items: center;
    gap: 0.8rem;
    animation: slideInRight 0.3s ease;
  }

  .notification-admin.error {
    background: var(--admin-danger);
  }

  .notification-admin.warning {
    background: var(--admin-warning);
  }

  /* –ó–∞–≥—Ä—É–∑–∫–∞ */
  .loading-admin {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
  }

  .spinner-admin {
    width: 60px;
    height: 60px;
    border: 5px solid rgba(255, 255, 255, 0.1);
    border-top: 5px solid var(--admin-accent);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
  @media (max-width: 1024px) {
    .charts-container {
      grid-template-columns: 1fr;
    }
    
    .form-grid {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 768px) {
    .admin-content {
      padding: 1rem;
    }
    
    .admin-nav {
      padding: 1rem;
    }
    
    .table-filters {
      flex-direction: column;
    }
    
    .form-actions {
      flex-direction: column;
    }
  }
</style>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>

<div id="loginContainer" class="login-container">
  <div class="login-box">
    <div class="login-header">
      <div class="login-icon">üëë</div>
      <h1 class="login-title">DROP SHOP Admin</h1>
      <p class="login-subtitle">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞–≥–∞–∑–∏–Ω–æ–º</p>
    </div>
    
    <div class="input-group">
      <label class="input-label">–õ–æ–≥–∏–Ω</label>
      <input type="text" id="adminLogin" class="input-field" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω" value="admin">
    </div>
    
    <div class="input-group">
      <label class="input-label">–ü–∞—Ä–æ–ª—å</label>
      <input type="password" id="adminPassword" class="input-field" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
    </div>
    
    <button class="login-btn" onclick="loginAdmin()">
      <i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    </button>
    
    <div id="loginError" class="error-message">
      <i class="fas fa-exclamation-circle"></i> –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å
    </div>
  </div>
</div>

<div id="adminPanel" class="admin-container">
  <div class="admin-header">
    <div class="admin-logo">
      <div class="admin-logo-icon">üëë</div>
      <div class="admin-logo-text">DROP SHOP | –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</div>
    </div>
    
    <div class="admin-actions">
      <div class="admin-time" id="currentTime">00:00:00</div>
      <button class="logout-btn" onclick="logoutAdmin()">
        <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
      </button>
    </div>
  </div>
  
  <div class="admin-nav">
    <button class="nav-tab active" onclick="switchTab('dashboard')">
      <i class="fas fa-tachometer-alt"></i> –î–∞—à–±–æ—Ä–¥
    </button>
    <button class="nav-tab" onclick="switchTab('products')">
      <i class="fas fa-box"></i> –¢–æ–≤–∞—Ä—ã
    </button>
    <button class="nav-tab" onclick="switchTab('addProduct')">
      <i class="fas fa-plus-circle"></i> –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
    </button>
    <button class="nav-tab" onclick="switchTab('orders')">
      <i class="fas fa-shopping-cart"></i> –ó–∞–∫–∞–∑—ã
    </button>
    <button class="nav-tab" onclick="switchTab('analytics')">
      <i class="fas fa-chart-line"></i> –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
    </button>
    <button class="nav-tab" onclick="switchTab('finance')">
      <i class="fas fa-money-bill-wave"></i> –§–∏–Ω–∞–Ω—Å—ã
    </button>
    <button class="nav-tab" onclick="switchTab('settings')">
      <i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    </button>
  </div>
  
  <div class="admin-content">
    <!-- –î–∞—à–±–æ—Ä–¥ -->
    <div id="dashboardTab" class="tab-content active">
      <div class="finance-stats">
        <div class="finance-card">
          <div class="finance-header">
            <div class="finance-icon">üí∞</div>
            <div class="stat-change positive">+12%</div>
          </div>
          <div class="finance-value revenue-value" id="totalRevenue">0 ‚ÇΩ</div>
          <div class="finance-label">–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞</div>
        </div>
        
        <div class="finance-card">
          <div class="finance-header">
            <div class="finance-icon">üíµ</div>
            <div class="stat-change positive">+15%</div>
          </div>
          <div class="finance-value profit-value" id="totalProfit">0 ‚ÇΩ</div>
          <div class="finance-label">–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å</div>
        </div>
        
        <div class="finance-card">
          <div class="finance-header">
            <div class="finance-icon">üìä</div>
            <div class="stat-change positive">+8%</div>
          </div>
          <div class="finance-value margin-value" id="avgMargin">0%</div>
          <div class="finance-label">–°—Ä–µ–¥–Ω—è—è –º–∞—Ä–∂–∞</div>
        </div>
        
        <div class="finance-card">
          <div class="finance-header">
            <div class="finance-icon">üì¶</div>
            <div class="stat-change positive">+5%</div>
          </div>
          <div class="finance-value" id="totalOrders">0</div>
          <div class="finance-label">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</div>
        </div>
      </div>
      
      <div class="order-stats">
        <div class="stat-badge">
          <div class="stat-badge-icon" style="background: rgba(52, 152, 219, 0.1); color: var(--admin-info);">
            <i class="fas fa-clock"></i>
          </div>
          <div class="stat-badge-content">
            <div class="stat-badge-value" id="newOrders">0</div>
            <div class="stat-badge-label">–ù–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã</div>
          </div>
        </div>
        
        <div class="stat-badge">
          <div class="stat-badge-icon" style="background: rgba(241, 196, 15, 0.1); color: var(--admin-warning);">
            <i class="fas fa-cogs"></i>
          </div>
          <div class="stat-badge-content">
            <div class="stat-badge-value" id="processingOrders">0</div>
            <div class="stat-badge-label">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</div>
          </div>
        </div>
        
        <div class="stat-badge">
          <div class="stat-badge-icon" style="background: rgba(155, 89, 182, 0.1); color: #9b59b6;">
            <i class="fas fa-truck"></i>
          </div>
          <div class="stat-badge-content">
            <div class="stat-badge-value" id="deliveryOrders">0</div>
            <div class="stat-badge-label">–ñ–¥–µ—Ç –¥–æ—Å—Ç–∞–≤–∫–∏</div>
          </div>
        </div>
        
        <div class="stat-badge">
          <div class="stat-badge-icon" style="background: rgba(39, 174, 96, 0.1); color: var(--admin-success);">
            <i class="fas fa-check-circle"></i>
          </div>
          <div class="stat-badge-content">
            <div class="stat-badge-value" id="completedOrders">0</div>
            <div class="stat-badge-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</div>
          </div>
        </div>
      </div>
      
      <div class="charts-container">
        <div class="chart-box">
          <div class="chart-title">üìà –î–∏–Ω–∞–º–∏–∫–∞ –ø—Ä–∏–±—ã–ª–∏</div>
          <canvas id="profitChart" class="chart-canvas"></canvas>
        </div>
        
        <div class="chart-box">
          <div class="chart-title">üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º</div>
          <canvas id="ordersChart" class="chart-canvas"></canvas>
        </div>
      </div>
    </div>
    
    <!-- –¢–æ–≤–∞—Ä—ã -->
    <div id="productsTab" class="tab-content">
      <div class="table-container">
        <div class="table-header">
          <div class="table-title">üè∑Ô∏è –í—Å–µ —Ç–æ–≤–∞—Ä—ã</div>
          <div class="table-filters">
            <select id="productFilter" class="form-control" style="width: auto;" onchange="filterProducts()">
              <option value="all">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</option>
              <option value="original">–û—Ä–∏–≥–∏–Ω–∞–ª—ã</option>
              <option value="replica">–†–µ–ø–ª–∏–∫–∏</option>
              <option value="highMargin">–í—ã—Å–æ–∫–∞—è –º–∞—Ä–∂–∞</option>
              <option value="lowMargin">–ù–∏–∑–∫–∞—è –º–∞—Ä–∂–∞</option>
            </select>
            <input type="text" class="form-control" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." onkeyup="searchProducts(this.value)" style="min-width: 200px;">
          </div>
        </div>
        
        <table class="data-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
              <th>–¢–∏–ø</th>
              <th>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å</th>
              <th>–¶–µ–Ω–∞</th>
              <th>–ú–∞—Ä–∂–∞</th>
              <th>–ü—Ä–∏–±—ã–ª—å</th>
              <th>–°—Ç–∞—Ç—É—Å</th>
              <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody id="productsTable">
            <!-- –¢–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
          </tbody>
        </table>
      </div>
    </div>
    
    <!-- –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä -->
    <div id="addProductTab" class="tab-content">
      <div class="form-container">
        <div class="form-title">
          <i class="fas fa-plus-circle"></i> –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
        </div>
        
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *</label>
            <input type="text" id="productName" class="form-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Nike Air Jordan 1">
          </div>
          
          <div class="form-group">
            <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
            <select id="productCategory" class="form-control">
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
              <option value="–æ–±—É–≤—å">–û–±—É–≤—å</option>
              <option value="–º—É–∂—Å–∫–∞—è">–ú—É–∂—Å–∫–∞—è –æ–¥–µ–∂–¥–∞</option>
              <option value="–∂–µ–Ω—Å–∫–∞—è">–ñ–µ–Ω—Å–∫–∞—è –æ–¥–µ–∂–¥–∞</option>
              <option value="–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</option>
              <option value="–≤–µ—Ä—Ö–Ω—è—è">–í–µ—Ä—Ö–Ω—è—è –æ–¥–µ–∂–¥–∞</option>
            </select>
          </div>
        </div>
        
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">–¢–∏–ø —Ç–æ–≤–∞—Ä–∞ *</label>
            <select id="productType" class="form-control">
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
              <option value="original">–û—Ä–∏–≥–∏–Ω–∞–ª</option>
              <option value="replica">–†–µ–ø–ª–∏–∫–∞</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">–°—Ç–∞—Ç—É—Å *</label>
            <select id="productAvailability" class="form-control">
              <option value="in_stock">–í –Ω–∞–ª–∏—á–∏–∏</option>
              <option value="preorder">–ü–æ–¥ –∑–∞–∫–∞–∑</option>
            </select>
          </div>
        </div>
        
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ) *</label>
            <input type="number" id="productCost" class="form-control" placeholder="5000" min="0" oninput="calculateMargin()">
          </div>
          
          <div class="form-group">
            <label class="form-label">–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ (‚ÇΩ) *</label>
            <input type="number" id="productPrice" class="form-control" placeholder="14990" min="0" oninput="calculateMargin()">
          </div>
          
          <div class="form-group">
            <label class="form-label">–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</label>
            <div id="marginIndicator" class="cost-indicator">
              <span id="profitAmount">0 ‚ÇΩ</span>
              <span id="marginPercentage" class="margin-indicator margin-good">0%</span>
            </div>
            <small style="color: var(--admin-text-light); display: block; margin-top: 0.3rem;">
              –ü—Ä–∏–±—ã–ª—å –∏ –º–∞—Ä–∂–∞ —Ä–∞—Å—Å—á–∏—Ç–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
            </small>
          </div>
        </div>
        
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ</label>
            <input type="number" id="productStock" class="form-control" value="10" min="0">
          </div>
          
          <div class="form-group">
            <label class="form-label">–†–∞–∑–º–µ—Ä—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
            <input type="text" id="productSizes" class="form-control" placeholder="40, 41, 42, 43, 44, 45">
          </div>
          
          <div class="form-group">
            <label class="form-label">–¶–≤–µ—Ç</label>
            <input type="text" id="productColor" class="form-control" placeholder="–ß–µ—Ä–Ω—ã–π">
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *</label>
          <textarea id="productDescription" class="form-control" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞..."></textarea>
        </div>
        
        <div class="form-group">
          <label class="form-label">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (URL —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é) *</label>
          <div class="image-upload-area" onclick="document.getElementById('productImages').focus()">
            <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; margin-bottom: 1rem; color: var(--admin-accent);"></i>
            <div style="font-size: 1.1rem; margin-bottom: 0.5rem;">–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</div>
            <div style="color: var(--admin-text-light); font-size: 0.9rem;">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Imgur, Unsplash –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã</div>
          </div>
          <input type="text" id="productImages" class="form-control" placeholder="https://example.com/image1.jpg, https://example.com/image2.jpg">
          <div class="image-preview" id="imagePreview"></div>
        </div>
        
        <div class="form-actions">
          <button class="btn btn-primary" onclick="addProduct()">
            <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä
          </button>
          <button class="btn btn-secondary" onclick="resetProductForm()">
            <i class="fas fa-redo"></i> –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
          </button>
        </div>
      </div>
    </div>
    
    <!-- –ó–∞–∫–∞–∑—ã -->
    <div id="ordersTab" class="tab-content">
      <div class="table-container">
        <div class="table-header">
          <div class="table-title">üì¶ –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</div>
          <div class="table-filters">
            <input type="date" id="orderDateFrom" class="form-control">
            <input type="date" id="orderDateTo" class="form-control">
            <select id="orderStatusFilter" class="form-control" onchange="filterOrders()">
              <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
              <option value="new">–ù–æ–≤—ã–µ</option>
              <option value="processing">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</option>
              <option value="delivery">–ñ–¥–µ—Ç –¥–æ—Å—Ç–∞–≤–∫–∏</option>
              <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</option>
              <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ</option>
            </select>
          </div>
        </div>
        
        <table class="data-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>–î–∞—Ç–∞</th>
              <th>–ö–ª–∏–µ–Ω—Ç</th>
              <th>–¢–æ–≤–∞—Ä—ã</th>
              <th>–°—É–º–º–∞</th>
              <th>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å</th>
              <th>–ü—Ä–∏–±—ã–ª—å</th>
              <th>–°—Ç–∞—Ç—É—Å</th>
              <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody id="ordersTable">
            <!-- –ó–∞–∫–∞–∑—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
          </tbody>
        </table>
      </div>
    </div>
    
    <!-- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
    <div id="analyticsTab" class="tab-content">
      <div class="form-container">
        <div class="form-title">
          <i class="fas fa-chart-line"></i> –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–æ–¥–∞–∂
        </div>
        
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">–ü–µ—Ä–∏–æ–¥</label>
            <select id="analyticsPeriod" class="form-control" onchange="updateAnalytics()">
              <option value="7">7 –¥–Ω–µ–π</option>
              <option value="30" selected>30 –¥–Ω–µ–π</option>
              <option value="90">90 –¥–Ω–µ–π</option>
              <option value="365">–ì–æ–¥</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">–¢–∏–ø —Ç–æ–≤–∞—Ä–æ–≤</label>
            <select id="analyticsType" class="form-control" onchange="updateAnalytics()">
              <option value="all">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</option>
              <option value="original">–¢–æ–ª—å–∫–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—ã</option>
              <option value="replica">–¢–æ–ª—å–∫–æ —Ä–µ–ø–ª–∏–∫–∏</option>
            </select>
          </div>
        </div>
        
        <div class="charts-container">
          <div class="chart-box">
            <div class="chart-title">üí∞ –î–∏–Ω–∞–º–∏–∫–∞ –≤—ã—Ä—É—á–∫–∏ –∏ –ø—Ä–∏–±—ã–ª–∏</div>
            <canvas id="revenueChart" class="chart-canvas"></canvas>
          </div>
          
          <div class="chart-box">
            <div class="chart-title">üì¶ –ü—Ä–æ–¥–∞–∂–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</div>
            <canvas id="categoryChart" class="chart-canvas"></canvas>
          </div>
        </div>
        
        <div class="table-container" style="margin-top: 2rem;">
          <div class="table-header">
            <div class="table-title">üèÜ –¢–æ–ø-5 —Å–∞–º—ã—Ö –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤</div>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>–¢–æ–≤–∞—Ä</th>
                <th>–ü—Ä–æ–¥–∞–Ω–æ</th>
                <th>–í—ã—Ä—É—á–∫–∞</th>
                <th>–ü—Ä–∏–±—ã–ª—å</th>
                <th>–ú–∞—Ä–∂–∞</th>
              </tr>
            </thead>
            <tbody id="topProductsTable"></tbody>
          </table>
        </div>
      </div>
    </div>
    
    <!-- –§–∏–Ω–∞–Ω—Å—ã -->
    <div id="financeTab" class="tab-content">
      <div class="form-container">
        <div class="form-title">
          <i class="fas fa-money-bill-wave"></i> –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç
        </div>
        
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">–û—Ç—á–µ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥</label>
            <select id="financePeriod" class="form-control" onchange="updateFinanceReport()">
              <option value="today">–°–µ–≥–æ–¥–Ω—è</option>
              <option value="yesterday">–í—á–µ—Ä–∞</option>
              <option value="week">–≠—Ç–∞ –Ω–µ–¥–µ–ª—è</option>
              <option value="month" selected>–≠—Ç–æ—Ç –º–µ—Å—è—Ü</option>
              <option value="quarter">–≠—Ç–æ—Ç –∫–≤–∞—Ä—Ç–∞–ª</option>
              <option value="year">–≠—Ç–æ—Ç –≥–æ–¥</option>
              <option value="all">–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">–¢–∏–ø –æ—Ç—á–µ—Ç–∞</label>
            <select id="financeType" class="form-control" onchange="updateFinanceReport()">
              <option value="summary">–°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç</option>
              <option value="detailed">–î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π</option>
              <option value="profit">–ü–æ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏</option>
            </select>
          </div>
        </div>
        
        <div class="finance-stats">
          <div class="finance-card">
            <div class="finance-header">
              <div class="finance-icon">üí∞</div>
            </div>
            <div class="finance-value revenue-value" id="periodRevenue">0 ‚ÇΩ</div>
            <div class="finance-label">–í—ã—Ä—É—á–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥</div>
          </div>
          
          <div class="finance-card">
            <div class="finance-header">
              <div class="finance-icon">üíµ</div>
            </div>
            <div class="finance-value profit-value" id="periodProfit">0 ‚ÇΩ</div>
            <div class="finance-label">–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å</div>
          </div>
          
          <div class="finance-card">
            <div class="finance-header">
              <div class="finance-icon">üìä</div>
            </div>
            <div class="finance-value margin-value" id="periodMargin">0%</div>
            <div class="finance-label">–ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å</div>
          </div>
          
          <div class="finance-card">
            <div class="finance-header">
              <div class="finance-icon">üì¶</div>
            </div>
            <div class="finance-value" id="periodOrders">0</div>
            <div class="finance-label">–ö–æ–ª-–≤–æ –∑–∞–∫–∞–∑–æ–≤</div>
          </div>
        </div>
        
        <div class="table-container" style="margin-top: 2rem;">
          <div class="table-header">
            <div class="table-title">üìã –î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç</div>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>–î–∞—Ç–∞</th>
                <th>–ó–∞–∫–∞–∑–æ–≤</th>
                <th>–í—ã—Ä—É—á–∫–∞</th>
                <th>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å</th>
                <th>–ü—Ä–∏–±—ã–ª—å</th>
                <th>–ú–∞—Ä–∂–∞</th>
              </tr>
            </thead>
            <tbody id="financeDetailsTable"></tbody>
          </table>
        </div>
      </div>
    </div>
    
    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <div id="settingsTab" class="tab-content">
      <div class="form-container">
        <div class="form-title">
          <i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞
        </div>
        
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞</label>
            <input type="text" id="shopName" class="form-control" value="DROP SHOP –Ø–∫—É—Ç—Å–∫">
          </div>
          
          <div class="form-group">
            <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏</label>
            <input type="text" id="shopPhone" class="form-control" value="+7 (999) 123-45-67">
          </div>
        </div>
        
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">Email –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</label>
            <input type="email" id="shopEmail" class="form-control" value="info@dropshop-ykt.ru">
          </div>
          
          <div class="form-group">
            <label class="form-label">–ê–¥—Ä–µ—Å –º–∞–≥–∞–∑–∏–Ω–∞</label>
            <input type="text" id="shopAddress" class="form-control" value="–Ø–∫—É—Ç—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, 15">
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">–¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞</label>
          <input type="text" id="telegramToken" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞">
          <small style="color: var(--admin-text-light); display: block; margin-top: 0.5rem;">
            –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö
          </small>
        </div>
        
        <div class="form-group">
          <label class="form-label">Chat ID Telegram</label>
          <input type="text" id="telegramChatId" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ Chat ID">
        </div>
        
        <div class="form-group">
          <label class="form-label">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏</label>
          <div style="display: flex; flex-direction: column; gap: 1rem; margin-top: 1rem;">
            <label style="display: flex; align-items: center; gap: 0.5rem;">
              <input type="checkbox" id="deliveryYakutsk" checked> –î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –Ø–∫—É—Ç—Å–∫—É
            </label>
            <label style="display: flex; align-items: center; gap: 0.5rem;">
              <input type="checkbox" id="pickupAvailable" checked> –°–∞–º–æ–≤—ã–≤–æ–∑
            </label>
            <label style="display: flex; align-items: center; gap: 0.5rem;">
              <input type="checkbox" id="freeDelivery" checked> –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –æ—Ç 5000‚ÇΩ
            </label>
          </div>
        </div>
        
        <div class="form-actions">
          <button class="btn btn-primary" onclick="saveSettings()">
            <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
          </button>
          <button class="btn btn-secondary" onclick="resetSettings()">
            <i class="fas fa-redo"></i> –°–±—Ä–æ—Å–∏—Ç—å
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="notificationContainer"></div>

<div class="loading-admin" id="loadingAdmin" style="display: none;">
  <div class="spinner-admin"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ADMIN_CONFIG = {
    login: "admin",
    password: "123456"
  };

  let currentTab = 'dashboard';
  let products = [];
  let orders = [];
  let profitChart = null;
  let ordersChart = null;
  let revenueChart = null;
  let categoryChart = null;

  // –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤
  const ORDER_STATUSES = {
    'new': { name: '–ù–æ–≤—ã–π', class: 'status-new', icon: 'fas fa-clock' },
    'processing': { name: '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ', class: 'status-processing', icon: 'fas fa-cogs' },
    'delivery': { name: '–ñ–¥–µ—Ç –¥–æ—Å—Ç–∞–≤–∫–∏', class: 'status-delivery', icon: 'fas fa-truck' },
    'completed': { name: '–ó–∞–≤–µ—Ä—à–µ–Ω', class: 'status-completed', icon: 'fas fa-check-circle' },
    'cancelled': { name: '–û—Ç–º–µ–Ω–µ–Ω', class: 'status-cancelled', icon: 'fas fa-times-circle' }
  };

  // –§—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  function loginAdmin() {
    const login = document.getElementById('adminLogin').value;
    const password = document.getElementById('adminPassword').value;
    const errorDiv = document.getElementById('loginError');

    if (login === ADMIN_CONFIG.login && password === ADMIN_CONFIG.password) {
      localStorage.setItem('adminLoggedIn', 'true');
      localStorage.setItem('adminSession', btoa(JSON.stringify({
        login: login,
        timestamp: Date.now()
      })));
      
      showAdminPanel();
      showNotification('‚úÖ –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è', 'success');
    } else {
      errorDiv.style.display = 'block';
      setTimeout(() => {
        errorDiv.style.display = 'none';
      }, 3000);
    }
  }

  function logoutAdmin() {
    localStorage.removeItem('adminLoggedIn');
    localStorage.removeItem('adminSession');
    location.reload();
  }

  function showAdminPanel() {
    document.getElementById('loginContainer').style.display = 'none';
    document.getElementById('adminPanel').style.display = 'block';
    
    updateCurrentTime();
    setInterval(updateCurrentTime, 1000);
    
    loadDashboardData();
  }

  function updateCurrentTime() {
    const now = new Date();
    const timeString = now.toLocaleTimeString('ru-RU');
    const dateString = now.toLocaleDateString('ru-RU', {
      weekday: 'long',
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });
    
    document.getElementById('currentTime').textContent = `${dateString} ${timeString}`;
  }

  function switchTab(tabName) {
    document.querySelectorAll('.tab-content').forEach(tab => {
      tab.classList.remove('active');
    });
    
    document.querySelectorAll('.nav-tab').forEach(btn => {
      btn.classList.remove('active');
    });
    
    document.getElementById(tabName + 'Tab').classList.add('active');
    event.target.classList.add('active');
    
    switch(tabName) {
      case 'dashboard':
        loadDashboardData();
        break;
      case 'products':
        loadProductsTable();
        break;
      case 'orders':
        loadOrders();
        break;
      case 'analytics':
        updateAnalytics();
        break;
      case 'finance':
        updateFinanceReport();
        break;
      case 'settings':
        loadSettings();
        break;
    }
    
    currentTab = tabName;
  }

  function showNotification(message, type = 'success') {
    const container = document.getElementById('notificationContainer');
    const notification = document.createElement('div');
    notification.className = `notification-admin ${type}`;
    notification.innerHTML = `
      <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
      <span>${message}</span>
    `;
    
    container.appendChild(notification);
    
    setTimeout(() => {
      notification.style.animation = 'slideInRight 0.3s ease reverse';
      setTimeout(() => notification.remove(), 300);
    }, 3000);
  }

  function showLoading(show) {
    document.getElementById('loadingAdmin').style.display = show ? 'flex' : 'none';
  }

  // –†–∞—Å—á–µ—Ç –º–∞—Ä–∂–∏
  function calculateMargin() {
    const cost = parseFloat(document.getElementById('productCost').value) || 0;
    const price = parseFloat(document.getElementById('productPrice').value) || 0;
    
    if (cost <= 0 || price <= 0) {
      document.getElementById('profitAmount').textContent = '0 ‚ÇΩ';
      document.getElementById('marginPercentage').textContent = '0%';
      document.getElementById('marginPercentage').className = 'margin-indicator margin-good';
      return;
    }
    
    const profit = price - cost;
    const margin = ((profit / price) * 100).toFixed(1);
    
    document.getElementById('profitAmount').textContent = `${profit.toLocaleString()} ‚ÇΩ`;
    document.getElementById('marginPercentage').textContent = `${margin}%`;
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ü–≤–µ—Ç –º–∞—Ä–∂–∏
    let marginClass = 'margin-good';
    if (margin < 20) {
      marginClass = 'margin-bad';
    } else if (margin < 40) {
      marginClass = 'margin-warning';
    }
    
    document.getElementById('marginPercentage').className = `margin-indicator ${marginClass}`;
  }

  // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–∞—à–±–æ—Ä–¥–∞
  async function loadDashboardData() {
    showLoading(true);
    
    try {
      // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä—ã
      products = JSON.parse(localStorage.getItem('adminProducts')) || [];
      
      // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–∫–∞–∑—ã
      orders = JSON.parse(localStorage.getItem('orders')) || [];
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
      updateDashboardStats();
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫–∏
      updateDashboardCharts();
      
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
      showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö', 'error');
    }
    
    showLoading(false);
  }

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–∞ –¥–∞—à–±–æ—Ä–¥–µ
  function updateDashboardStats() {
    // –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ –∏ –ø—Ä–∏–±—ã–ª—å
    let totalRevenue = 0;
    let totalCost = 0;
    let totalProfit = 0;
    let orderCounts = { new: 0, processing: 0, delivery: 0, completed: 0, cancelled: 0 };
    
    orders.forEach(order => {
      // –°—É–º–º–∞ –∑–∞–∫–∞–∑–∞
      const amount = parseFloat(order.total?.replace(/[^\d]/g, '') || 0);
      totalRevenue += amount;
      
      // –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ)
      if (order.cost) {
        totalCost += order.cost;
      } else {
        // –û—Ü–µ–Ω–∏–≤–∞–µ–º —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–∞–∫ 60% –æ—Ç —Ü–µ–Ω—ã, –µ—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
        totalCost += amount * 0.6;
      }
      
      // –°—á–∏—Ç–∞–µ–º –∑–∞–∫–∞–∑—ã –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
      if (ORDER_STATUSES[order.status]) {
        orderCounts[order.status]++;
      } else {
        orderCounts.new++;
      }
    });
    
    // –ü—Ä–∏–±—ã–ª—å
    totalProfit = totalRevenue - totalCost;
    const avgMargin = totalRevenue > 0 ? ((totalProfit / totalRevenue) * 100) : 0;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
    document.getElementById('totalRevenue').textContent = formatCurrency(totalRevenue);
    document.getElementById('totalProfit').textContent = formatCurrency(totalProfit);
    document.getElementById('avgMargin').textContent = `${avgMargin.toFixed(1)}%`;
    document.getElementById('totalOrders').textContent = orders.length;
    
    // –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤
    document.getElementById('newOrders').textContent = orderCounts.new;
    document.getElementById('processingOrders').textContent = orderCounts.processing;
    document.getElementById('deliveryOrders').textContent = orderCounts.delivery;
    document.getElementById('completedOrders').textContent = orderCounts.completed;
  }

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –¥–∞—à–±–æ—Ä–¥–∞
  function updateDashboardCharts() {
    // –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏–±—ã–ª–∏
    const profitCtx = document.getElementById('profitChart').getContext('2d');
    
    if (profitChart) {
      profitChart.destroy();
    }
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
    const days = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
    const revenueData = days.map(() => Math.floor(Math.random() * 50000) + 20000);
    const profitData = revenueData.map(revenue => Math.floor(revenue * (0.3 + Math.random() * 0.2)));
    
    profitChart = new Chart(profitCtx, {
      type: 'line',
      data: {
        labels: days,
        datasets: [
          {
            label: '–í—ã—Ä—É—á–∫–∞',
            data: revenueData,
            borderColor: '#FFD700',
            backgroundColor: 'rgba(255, 215, 0, 0.1)',
            borderWidth: 3,
            fill: true,
            tension: 0.4
          },
          {
            label: '–ü—Ä–∏–±—ã–ª—å',
            data: profitData,
            borderColor: '#2ecc71',
            backgroundColor: 'rgba(46, 204, 113, 0.1)',
            borderWidth: 3,
            fill: true,
            tension: 0.4
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            labels: {
              color: 'var(--admin-text)'
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            grid: {
              color: 'rgba(255, 255, 255, 0.05)'
            },
            ticks: {
              color: 'var(--admin-text-light)',
              callback: function(value) {
                return (value / 1000).toFixed(0) + 'k';
              }
            }
          },
          x: {
            grid: {
              color: 'rgba(255, 255, 255, 0.05)'
            },
            ticks: {
              color: 'var(--admin-text-light)'
            }
          }
        }
      }
    });
    
    // –ì—Ä–∞—Ñ–∏–∫ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–æ–≤
    const ordersCtx = document.getElementById('ordersChart').getContext('2d');
    
    if (ordersChart) {
      ordersChart.destroy();
    }
    
    // –°—á–∏—Ç–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
    const statusCounts = {
      '–ù–æ–≤—ã–µ': orders.filter(o => !o.status || o.status === 'new').length,
      '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ': orders.filter(o => o.status === 'processing').length,
      '–ñ–¥–µ—Ç –¥–æ—Å—Ç–∞–≤–∫–∏': orders.filter(o => o.status === 'delivery').length,
      '–ó–∞–≤–µ—Ä—à–µ–Ω—ã': orders.filter(o => o.status === 'completed').length,
      '–û—Ç–º–µ–Ω–µ–Ω—ã': orders.filter(o => o.status === 'cancelled').length
    };
    
    ordersChart = new Chart(ordersCtx, {
      type: 'doughnut',
      data: {
        labels: Object.keys(statusCounts),
        datasets: [{
          data: Object.values(statusCounts),
          backgroundColor: [
            'rgba(52, 152, 219, 0.8)',
            'rgba(241, 196, 15, 0.8)',
            'rgba(155, 89, 182, 0.8)',
            'rgba(39, 174, 96, 0.8)',
            'rgba(231, 76, 60, 0.8)'
          ],
          borderWidth: 2,
          borderColor: 'var(--admin-secondary)'
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'right',
            labels: {
              color: 'var(--admin-text)',
              padding: 20
            }
          }
        },
        cutout: '70%'
      }
    });
  }

  // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª—é—Ç—ã
  function formatCurrency(amount) {
    return new Intl.NumberFormat('ru-RU', {
      style: 'currency',
      currency: 'RUB',
      minimumFractionDigits: 0
    }).format(amount);
  }

  // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–±–ª–∏—Ü—ã —Ç–æ–≤–∞—Ä–æ–≤
  function loadProductsTable() {
    showLoading(true);
    
    try {
      products = JSON.parse(localStorage.getItem('adminProducts')) || [];
      const container = document.getElementById('productsTable');
      
      if (products.length === 0) {
        container.innerHTML = `
          <tr>
            <td colspan="9" style="text-align: center; padding: 2rem; color: var(--admin-text-light);">
              <i class="fas fa-box-open" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
              –¢–æ–≤–∞—Ä–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç
            </td>
          </tr>
        `;
        showLoading(false);
        return;
      }
      
      container.innerHTML = products.map(product => {
        const cost = product.cost || 0;
        const price = product.price || 0;
        const profit = price - cost;
        const margin = price > 0 ? ((profit / price) * 100) : 0;
        
        let marginClass = 'margin-good';
        if (margin < 20) {
          marginClass = 'margin-bad';
        } else if (margin < 40) {
          marginClass = 'margin-warning';
        }
        
        return `
          <tr>
            <td><strong>#${product.id}</strong></td>
            <td>${product.name}</td>
            <td><span class="status-badge ${product.type === 'original' ? 'status-active' : 'status-pending'}">
              ${product.type === 'original' ? '–û—Ä–∏–≥–∏–Ω–∞–ª' : '–†–µ–ø–ª–∏–∫–∞'}
            </span></td>
            <td>${formatCurrency(cost)}</td>
            <td>${formatCurrency(price)}</td>
            <td><span class="margin-indicator ${marginClass}">${margin.toFixed(1)}%</span></td>
            <td><span class="profit-badge ${profit >= 0 ? 'profit-positive' : 'profit-negative'}">
              ${formatCurrency(profit)}
            </span></td>
            <td><span class="status-badge ${product.availability === 'in_stock' ? 'status-active' : 'status-processing'}">
              ${product.availability === 'in_stock' ? '–í –Ω–∞–ª–∏—á–∏–∏' : '–ü–æ–¥ –∑–∞–∫–∞–∑'}
            </span></td>
            <td>
              <div class="table-actions">
                <button class="action-btn edit" onclick="editProduct(${product.id})">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="action-btn delete" onclick="deleteProduct(${product.id})">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        `;
      }).join('');
      
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤:', error);
      showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤', 'error');
    }
    
    showLoading(false);
  }

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ —Å —É—á–µ—Ç–æ–º —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏
  function addProduct() {
    showLoading(true);
    
    try {
      // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
      const productId = Date.now();
      const productName = document.getElementById('productName').value.trim();
      const productCategory = document.getElementById('productCategory').value;
      const productType = document.getElementById('productType').value;
      const productAvailability = document.getElementById('productAvailability').value;
      const productCost = parseFloat(document.getElementById('productCost').value) || 0;
      const productPrice = parseFloat(document.getElementById('productPrice').value) || 0;
      const productDescription = document.getElementById('productDescription').value.trim();
      const productImages = document.getElementById('productImages').value.split(',').map(url => url.trim()).filter(url => url);
      
      // –í–∞–ª–∏–¥–∞—Ü–∏—è
      if (!productName || !productCategory || !productType || !productCost || !productPrice || !productDescription || productImages.length === 0) {
        showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
        showLoading(false);
        return;
      }
      
      if (productCost >= productPrice) {
        showNotification('–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –º–µ–Ω—å—à–µ —Ü–µ–Ω—ã –ø—Ä–æ–¥–∞–∂–∏', 'error');
        showLoading(false);
        return;
      }
      
      // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–∏–±—ã–ª—å –∏ –º–∞—Ä–∂—É
      const profit = productPrice - productCost;
      const margin = (profit / productPrice * 100).toFixed(1);
      
      // 1. –°–æ–∑–¥–∞–µ–º —Ç–æ–≤–∞—Ä –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞
      const catalogProduct = {
        id: productId,
        name: productName,
        price: productPrice,
        cost: productCost,
        originalPrice: Math.round(productPrice * 1.5),
        type: productType,
        category: productCategory,
        image: productImages[0],
        rating: 4.0 + (Math.random() * 0.5),
        reviews: Math.floor(Math.random() * 50),
        badge: '–ù–æ–≤–∏–Ω–∫–∞',
        inStock: productAvailability === 'in_stock',
        deliveryTime: productType === 'original' ? '7-14 –¥–Ω–µ–π' : '2-3 —á–∞—Å–∞'
      };
      
      // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∫–∞—Ç–∞–ª–æ–≥
      let catalogProducts = JSON.parse(localStorage.getItem('catalogProducts')) || [];
      catalogProducts.push(catalogProduct);
      localStorage.setItem('catalogProducts', JSON.stringify(catalogProducts));
      
      // 2. –°–æ–∑–¥–∞–µ–º –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–æ–≤–∞—Ä–∞
      const detailedProduct = {
        id: productId,
        name: productName,
        price: productPrice,
        cost: productCost,
        originalPrice: catalogProduct.originalPrice,
        type: productType,
        category: productCategory,
        description: productDescription,
        images: productImages,
        sizes: document.getElementById('productSizes').value.split(',').map(s => s.trim()).filter(s => s) || ['M', 'L', 'XL'],
        color: document.getElementById('productColor').value.trim() || '–ß–µ—Ä–Ω—ã–π',
        material: '–•–ª–æ–ø–æ–∫ 100%',
        inStock: productAvailability === 'in_stock',
        stockCount: parseInt(document.getElementById('productStock').value) || 10,
        rating: catalogProduct.rating,
        reviews: [],
        deliveryTime: catalogProduct.deliveryTime,
        profit: profit,
        margin: margin
      };
      
      // –î–æ–±–∞–≤–ª—è–µ–º –≤ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
      let detailedProducts = JSON.parse(localStorage.getItem('detailedProducts')) || {};
      detailedProducts[productId] = detailedProduct;
      localStorage.setItem('detailedProducts', JSON.stringify(detailedProducts));
      
      // 3. –°–æ–∑–¥–∞–µ–º –∞–¥–º–∏–Ω—Å–∫—É—é –≤–µ—Ä—Å–∏—é (—Å —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å—é)
      const adminProduct = {
        id: productId,
        name: productName,
        category: productCategory,
        type: productType,
        availability: productAvailability,
        cost: productCost,
        price: productPrice,
        profit: profit,
        margin: margin,
        stock: parseInt(document.getElementById('productStock').value) || 10,
        sizes: detailedProduct.sizes,
        color: detailedProduct.color,
        description: productDescription,
        images: productImages,
        createdAt: new Date().toISOString(),
        rating: catalogProduct.rating,
        reviews: [],
        badge: '–ù–æ–≤–∏–Ω–∫–∞',
        deliveryTime: catalogProduct.deliveryTime
      };
      
      // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∞–¥–º–∏–Ω—Å–∫–∏–µ —Ç–æ–≤–∞—Ä—ã
      let adminProducts = JSON.parse(localStorage.getItem('adminProducts')) || [];
      adminProducts.push(adminProduct);
      localStorage.setItem('adminProducts', JSON.stringify(adminProducts));
      
      // 4. –î–æ–±–∞–≤–ª—è–µ–º –≤ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
      let popularProducts = JSON.parse(localStorage.getItem('popularProducts')) || [];
      popularProducts.push({
        id: productId,
        name: productName,
        price: productPrice,
        cost: productCost,
        image: productImages[0],
        type: productType,
        category: productCategory,
        inStock: productAvailability === 'in_stock',
        profit: profit
      });
      
      // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 12 —Ç–æ–≤–∞—Ä–æ–≤
      popularProducts = popularProducts.slice(-12);
      localStorage.setItem('popularProducts', JSON.stringify(popularProducts));
      
      showNotification(`‚úÖ –¢–æ–≤–∞—Ä "${productName}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω! –ü—Ä–∏–±—ã–ª—å: ${profit.toLocaleString()} ‚ÇΩ (${margin}%)`, 'success');
      resetProductForm();
      loadProductsTable();
      
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞:', error);
      showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞', 'error');
    }
    
    showLoading(false);
  }

  function resetProductForm() {
    document.getElementById('productName').value = '';
    document.getElementById('productCategory').value = '';
    document.getElementById('productType').value = '';
    document.getElementById('productAvailability').value = 'in_stock';
    document.getElementById('productCost').value = '';
    document.getElementById('productPrice').value = '';
    document.getElementById('productStock').value = '10';
    document.getElementById('productSizes').value = '';
    document.getElementById('productColor').value = '';
    document.getElementById('productDescription').value = '';
    document.getElementById('productImages').value = '';
    document.getElementById('imagePreview').innerHTML = '';
    calculateMargin();
    
    showNotification('–§–æ—Ä–º–∞ –æ—á–∏—â–µ–Ω–∞', 'info');
  }

  function editProduct(productId) {
    const product = products.find(p => p.id === productId);
    if (!product) {
      showNotification('–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
      return;
    }
    
    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
    switchTab('addProduct');
    
    // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞
    setTimeout(() => {
      document.getElementById('productName').value = product.name || '';
      document.getElementById('productCategory').value = product.category || '';
      document.getElementById('productType').value = product.type || '';
      document.getElementById('productAvailability').value = product.availability || 'in_stock';
      document.getElementById('productCost').value = product.cost || '';
      document.getElementById('productPrice').value = product.price || '';
      document.getElementById('productStock').value = product.stock || 10;
      document.getElementById('productSizes').value = product.sizes ? product.sizes.join(', ') : '';
      document.getElementById('productColor').value = product.color || '';
      document.getElementById('productDescription').value = product.description || '';
      document.getElementById('productImages').value = product.images ? product.images.join(', ') : '';
      
      calculateMargin();
      showNotification('–§–æ—Ä–º–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞. –û–±–Ω–æ–≤–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.', 'info');
    }, 300);
  }

  function deleteProduct(productId) {
    if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
      return;
    }
    
    showLoading(true);
    
    try {
      // –£–¥–∞–ª—è–µ–º –∏–∑ –≤—Å–µ—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â
      let adminProducts = JSON.parse(localStorage.getItem('adminProducts')) || [];
      adminProducts = adminProducts.filter(p => p.id !== productId);
      localStorage.setItem('adminProducts', JSON.stringify(adminProducts));
      
      let catalogProducts = JSON.parse(localStorage.getItem('catalogProducts')) || [];
      catalogProducts = catalogProducts.filter(p => p.id !== productId);
      localStorage.setItem('catalogProducts', JSON.stringify(catalogProducts));
      
      let detailedProducts = JSON.parse(localStorage.getItem('detailedProducts')) || {};
      delete detailedProducts[productId];
      localStorage.setItem('detailedProducts', JSON.stringify(detailedProducts));
      
      let popularProducts = JSON.parse(localStorage.getItem('popularProducts')) || [];
      popularProducts = popularProducts.filter(p => p.id !== productId);
      localStorage.setItem('popularProducts', JSON.stringify(popularProducts));
      
      showNotification('–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω', 'success');
      loadProductsTable();
      
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞:', error);
      showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞', 'error');
    }
    
    showLoading(false);
  }

  // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤ —Å —É—á–µ—Ç–æ–º —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏ –ø—Ä–∏–±—ã–ª–∏
  function loadOrders() {
    showLoading(true);
    
    orders = JSON.parse(localStorage.getItem('orders')) || [];
    const container = document.getElementById('ordersTable');
    
    if (orders.length === 0) {
      container.innerHTML = `
        <tr>
          <td colspan="9" style="text-align: center; padding: 2rem; color: var(--admin-text-light);">
            <i class="fas fa-shopping-cart" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
            –ó–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç
          </td>
        </tr>
      `;
      showLoading(false);
      return;
    }
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–≤–∞—Ä–∞—Ö –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏
    const detailedProducts = JSON.parse(localStorage.getItem('detailedProducts')) || {};
    
    const sortedOrders = [...orders].sort((a, b) => new Date(b.date || 0) - new Date(a.date || 0));
    
    container.innerHTML = sortedOrders.map(order => {
      // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ –ø—Ä–∏–±—ã–ª—å –¥–ª—è –∑–∞–∫–∞–∑–∞
      let totalCost = 0;
      let totalRevenue = parseFloat(order.total?.replace(/[^\d]/g, '') || 0);
      let profit = 0;
      
      if (order.items && order.items.length > 0) {
        order.items.forEach(item => {
          const product = detailedProducts[item.id];
          if (product && product.cost) {
            totalCost += product.cost * (item.quantity || 1);
          } else {
            // –ï—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏, –æ—Ü–µ–Ω–∏–≤–∞–µ–º –∫–∞–∫ 60% –æ—Ç —Ü–µ–Ω—ã
            totalCost += (item.price || 0) * 0.6 * (item.quantity || 1);
          }
        });
      } else {
        // –ï—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–æ–≤–∞—Ä–∞—Ö, –æ—Ü–µ–Ω–∏–≤–∞–µ–º —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–∞–∫ 60% –æ—Ç –≤—ã—Ä—É—á–∫–∏
        totalCost = totalRevenue * 0.6;
      }
      
      profit = totalRevenue - totalCost;
      const margin = totalRevenue > 0 ? ((profit / totalRevenue) * 100) : 0;
      
      // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
      const status = order.status || 'new';
      const statusInfo = ORDER_STATUSES[status] || ORDER_STATUSES['new'];
      
      return `
        <tr>
          <td><strong>#${order.id || '0000'}</strong></td>
          <td>${formatDate(order.date)}</td>
          <td>${order.name || '–ë–µ–∑ –∏–º–µ–Ω–∏'}<br><small>${order.phone || ''}</small></td>
          <td>${order.items ? order.items.length + ' —à—Ç.' : '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}</td>
          <td>${formatCurrency(totalRevenue)}</td>
          <td>${formatCurrency(totalCost)}</td>
          <td><span class="profit-badge ${profit >= 0 ? 'profit-positive' : 'profit-negative'}">
            ${formatCurrency(profit)}<br><small>${margin.toFixed(1)}%</small>
          </span></td>
          <td>
            <span class="status-badge ${statusInfo.class}">
              <i class="${statusInfo.icon}"></i> ${statusInfo.name}
            </span>
          </td>
          <td>
            <div class="table-actions">
              <button class="action-btn view" onclick="viewOrder('${order.id}')">
                <i class="fas fa-eye"></i>
              </button>
              <button class="action-btn edit" onclick="editOrder('${order.id}')">
                <i class="fas fa-edit"></i>
              </button>
              <button class="action-btn delete" onclick="deleteOrder('${order.id}')">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      `;
    }).join('');
    
    showLoading(false);
  }

  function viewOrder(orderId) {
    const order = orders.find(o => o.id == orderId);
    
    if (!order) {
      showNotification('–ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
      return;
    }
    
    const detailedProducts = JSON.parse(localStorage.getItem('detailedProducts')) || {};
    let itemsText = '';
    let totalCost = 0;
    let totalRevenue = 0;
    
    if (order.items && order.items.length > 0) {
      itemsText = order.items.map(item => {
        const product = detailedProducts[item.id];
        const cost = product ? product.cost || 0 : 0;
        const itemCost = cost * (item.quantity || 1);
        totalCost += itemCost;
        totalRevenue += (item.price || 0) * (item.quantity || 1);
        
        return `${item.name} - ${item.quantity || 1} —à—Ç. √ó ${formatCurrency(item.price)} = ${formatCurrency(item.price * (item.quantity || 1))} (—Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å: ${formatCurrency(itemCost)})`;
      }).join('\n');
    } else {
      totalRevenue = parseFloat(order.total?.replace(/[^\d]/g, '') || 0);
      totalCost = totalRevenue * 0.6;
    }
    
    const profit = totalRevenue - totalCost;
    const margin = totalRevenue > 0 ? ((profit / totalRevenue) * 100) : 0;
    const status = order.status || 'new';
    const statusInfo = ORDER_STATUSES[status] || ORDER_STATUSES['new'];
    
    const message = `
–ó–∞–∫–∞–∑ #${order.id}
–î–∞—Ç–∞: ${order.date || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}
–°—Ç–∞—Ç—É—Å: ${statusInfo.name}

–ö–ª–∏–µ–Ω—Ç: ${order.name || '–ù–µ —É–∫–∞–∑–∞–Ω'}
–¢–µ–ª–µ—Ñ–æ–Ω: ${order.phone || '–ù–µ —É–∫–∞–∑–∞–Ω'}
Email: ${order.email || '–ù–µ —É–∫–∞–∑–∞–Ω'}
–ê–¥—Ä–µ—Å: ${order.address || '–ù–µ —É–∫–∞–∑–∞–Ω'}

–¢–æ–≤–∞—Ä—ã:
${itemsText || '–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏'}

–§–∏–Ω–∞–Ω—Å—ã:
–í—ã—Ä—É—á–∫–∞: ${formatCurrency(totalRevenue)}
–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å: ${formatCurrency(totalCost)}
–ü—Ä–∏–±—ã–ª—å: ${formatCurrency(profit)} (${margin.toFixed(1)}%)
    `.trim();

    alert(message);
  }

  function editOrder(orderId) {
    const order = orders.find(o => o.id == orderId);
    
    if (!order) {
      showNotification('–ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
      return;
    }
    
    const statusHtml = Object.entries(ORDER_STATUSES).map(([key, value]) => `
      <option value="${key}" ${order.status === key ? 'selected' : ''}>
        ${value.name}
      </option>
    `).join('');
    
    const modalContent = `
      <div style="padding: 1rem 0;">
        <div class="form-group">
          <label class="form-label">–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞</label>
          <select id="editOrderStatus" class="form-control">
            ${statusHtml}
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É</label>
          <textarea id="editOrderComment" class="form-control" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π...">${order.comment || ''}</textarea>
        </div>
        <div class="form-actions" style="margin-top: 1.5rem;">
          <button class="btn btn-primary" onclick="saveOrderChanges('${orderId}')">
            <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
          </button>
        </div>
      </div>
    `;
    
    showCustomModal('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ #' + order.id, modalContent);
  }

  function saveOrderChanges(orderId) {
    const orderIndex = orders.findIndex(o => o.id == orderId);
    
    if (orderIndex === -1) {
      showNotification('–ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
      return;
    }
    
    const newStatus = document.getElementById('editOrderStatus').value;
    const comment = document.getElementById('editOrderComment').value;
    
    orders[orderIndex].status = newStatus;
    orders[orderIndex].comment = comment;
    orders[orderIndex].updatedAt = new Date().toISOString();
    
    localStorage.setItem('orders', JSON.stringify(orders));
    
    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    document.querySelector('.modal-backdrop')?.remove();
    document.querySelector('.custom-modal')?.remove();
    
    showNotification('–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
    loadOrders();
    loadDashboardData(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
  }

  function deleteOrder(orderId) {
    if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∑–∞–∫–∞–∑? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
      return;
    }
    
    orders = orders.filter(o => o.id != orderId);
    localStorage.setItem('orders', JSON.stringify(orders));
    
    showNotification('–ó–∞–∫–∞–∑ —É–¥–∞–ª–µ–Ω', 'success');
    loadOrders();
    loadDashboardData();
  }

  function filterOrders() {
    const statusFilter = document.getElementById('orderStatusFilter').value;
    const dateFrom = document.getElementById('orderDateFrom').value;
    const dateTo = document.getElementById('orderDateTo').value;
    
    let filteredOrders = [...orders];
    
    if (statusFilter !== 'all') {
      filteredOrders = filteredOrders.filter(order => order.status === statusFilter);
    }
    
    if (dateFrom) {
      const fromDate = new Date(dateFrom);
      filteredOrders = filteredOrders.filter(order => {
        const orderDate = new Date(order.date || 0);
        return orderDate >= fromDate;
      });
    }
    
    if (dateTo) {
      const toDate = new Date(dateTo);
      toDate.setHours(23, 59, 59, 999);
      filteredOrders = filteredOrders.filter(order => {
        const orderDate = new Date(order.date || 0);
        return orderDate <= toDate;
      });
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É —Å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–∞–∫–∞–∑–∞–º–∏
    const container = document.getElementById('ordersTable');
    
    if (filteredOrders.length === 0) {
      container.innerHTML = `
        <tr>
          <td colspan="9" style="text-align: center; padding: 2rem; color: var(--admin-text-light);">
            <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
            –ó–∞–∫–∞–∑—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–∞–º
          </td>
        </tr>
      `;
      return;
    }
    
    // –ü–æ–≤—Ç–æ—Ä—è–µ–º –ª–æ–≥–∏–∫—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
    const detailedProducts = JSON.parse(localStorage.getItem('detailedProducts')) || {};
    
    container.innerHTML = filteredOrders.map(order => {
      let totalCost = 0;
      let totalRevenue = parseFloat(order.total?.replace(/[^\d]/g, '') || 0);
      
      if (order.items && order.items.length > 0) {
        order.items.forEach(item => {
          const product = detailedProducts[item.id];
          if (product && product.cost) {
            totalCost += product.cost * (item.quantity || 1);
          } else {
            totalCost += (item.price || 0) * 0.6 * (item.quantity || 1);
          }
        });
      } else {
        totalCost = totalRevenue * 0.6;
      }
      
      const profit = totalRevenue - totalCost;
      const margin = totalRevenue > 0 ? ((profit / totalRevenue) * 100) : 0;
      const status = order.status || 'new';
      const statusInfo = ORDER_STATUSES[status] || ORDER_STATUSES['new'];
      
      return `
        <tr>
          <td><strong>#${order.id || '0000'}</strong></td>
          <td>${formatDate(order.date)}</td>
          <td>${order.name || '–ë–µ–∑ –∏–º–µ–Ω–∏'}<br><small>${order.phone || ''}</small></td>
          <td>${order.items ? order.items.length + ' —à—Ç.' : '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}</td>
          <td>${formatCurrency(totalRevenue)}</td>
          <td>${formatCurrency(totalCost)}</td>
          <td><span class="profit-badge ${profit >= 0 ? 'profit-positive' : 'profit-negative'}">
            ${formatCurrency(profit)}<br><small>${margin.toFixed(1)}%</small>
          </span></td>
          <td>
            <span class="status-badge ${statusInfo.class}">
              <i class="${statusInfo.icon}"></i> ${statusInfo.name}
            </span>
          </td>
          <td>
            <div class="table-actions">
              <button class="action-btn view" onclick="viewOrder('${order.id}')">
                <i class="fas fa-eye"></i>
              </button>
              <button class="action-btn edit" onclick="editOrder('${order.id}')">
                <i class="fas fa-edit"></i>
              </button>
            </div>
          </td>
        </tr>
      `;
    }).join('');
  }

  // –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç
  function updateFinanceReport() {
    showLoading(true);
    
    try {
      const period = document.getElementById('financePeriod').value;
      const reportType = document.getElementById('financeType').value;
      
      // –§–∏–ª—å—Ç—Ä—É–µ–º –∑–∞–∫–∞–∑—ã –ø–æ –ø–µ—Ä–∏–æ–¥—É
      let filteredOrders = [...orders];
      const now = new Date();
      
      switch(period) {
        case 'today':
          const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
          filteredOrders = filteredOrders.filter(order => new Date(order.date) >= today);
          break;
        case 'yesterday':
          const yesterday = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 1);
          const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());
          filteredOrders = filteredOrders.filter(order => {
            const orderDate = new Date(order.date);
            return orderDate >= yesterday && orderDate < todayStart;
          });
          break;
        case 'week':
          const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
          filteredOrders = filteredOrders.filter(order => new Date(order.date) >= weekAgo);
          break;
        case 'month':
          const monthAgo = new Date(now.getFullYear(), now.getMonth() - 1, now.getDate());
          filteredOrders = filteredOrders.filter(order => new Date(order.date) >= monthAgo);
          break;
        case 'quarter':
          const quarterAgo = new Date(now.getFullYear(), now.getMonth() - 3, now.getDate());
          filteredOrders = filteredOrders.filter(order => new Date(order.date) >= quarterAgo);
          break;
        case 'year':
          const yearAgo = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());
          filteredOrders = filteredOrders.filter(order => new Date(order.date) >= yearAgo);
          break;
        // 'all' - –≤—Å–µ –∑–∞–∫–∞–∑—ã
      }
      
      // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
      let totalRevenue = 0;
      let totalCost = 0;
      let totalProfit = 0;
      
      const detailedProducts = JSON.parse(localStorage.getItem('detailedProducts')) || {};
      
      filteredOrders.forEach(order => {
        const revenue = parseFloat(order.total?.replace(/[^\d]/g, '') || 0);
        totalRevenue += revenue;
        
        let orderCost = 0;
        if (order.items && order.items.length > 0) {
          order.items.forEach(item => {
            const product = detailedProducts[item.id];
            if (product && product.cost) {
              orderCost += product.cost * (item.quantity || 1);
            } else {
              orderCost += (item.price || 0) * 0.6 * (item.quantity || 1);
            }
          });
        } else {
          orderCost = revenue * 0.6;
        }
        
        totalCost += orderCost;
      });
      
      totalProfit = totalRevenue - totalCost;
      const avgMargin = totalRevenue > 0 ? ((totalProfit / totalRevenue) * 100) : 0;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
      document.getElementById('periodRevenue').textContent = formatCurrency(totalRevenue);
      document.getElementById('periodProfit').textContent = formatCurrency(totalProfit);
      document.getElementById('periodMargin').textContent = `${avgMargin.toFixed(1)}%`;
      document.getElementById('periodOrders').textContent = filteredOrders.length;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
      updateFinanceDetailsTable(filteredOrders, reportType);
      
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞:', error);
      showNotification('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–∞', 'error');
    }
    
    showLoading(false);
  }

  function updateFinanceDetailsTable(filteredOrders, reportType) {
    const container = document.getElementById('financeDetailsTable');
    const detailedProducts = JSON.parse(localStorage.getItem('detailedProducts')) || {};
    
    if (filteredOrders.length === 0) {
      container.innerHTML = `
        <tr>
          <td colspan="6" style="text-align: center; padding: 2rem; color: var(--admin-text-light);">
            <i class="fas fa-chart-bar" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
            –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥
          </td>
        </tr>
      `;
      return;
    }
    
    // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –∑–∞–∫–∞–∑—ã –ø–æ –¥–∞—Ç–µ
    const ordersByDate = {};
    filteredOrders.forEach(order => {
      const date = new Date(order.date).toLocaleDateString('ru-RU');
      if (!ordersByDate[date]) {
        ordersByDate[date] = [];
      }
      ordersByDate[date].push(order);
    });
    
    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞—Ç—ã
    const sortedDates = Object.keys(ordersByDate).sort((a, b) => new Date(b) - new Date(a));
    
    // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
    let tableRows = '';
    
    sortedDates.forEach(date => {
      const dateOrders = ordersByDate[date];
      let dateRevenue = 0;
      let dateCost = 0;
      let dateProfit = 0;
      
      dateOrders.forEach(order => {
        const revenue = parseFloat(order.total?.replace(/[^\d]/g, '') || 0);
        dateRevenue += revenue;
        
        let orderCost = 0;
        if (order.items && order.items.length > 0) {
          order.items.forEach(item => {
            const product = detailedProducts[item.id];
            if (product && product.cost) {
              orderCost += product.cost * (item.quantity || 1);
            } else {
              orderCost += (item.price || 0) * 0.6 * (item.quantity || 1);
            }
          });
        } else {
          orderCost = revenue * 0.6;
        }
        
        dateCost += orderCost;
      });
      
      dateProfit = dateRevenue - dateCost;
      const dateMargin = dateRevenue > 0 ? ((dateProfit / dateRevenue) * 100) : 0;
      
      tableRows += `
        <tr>
          <td>${date}</td>
          <td>${dateOrders.length}</td>
          <td>${formatCurrency(dateRevenue)}</td>
          <td>${formatCurrency(dateCost)}</td>
          <td><span class="profit-badge ${dateProfit >= 0 ? 'profit-positive' : 'profit-negative'}">
            ${formatCurrency(dateProfit)}
          </span></td>
          <td>${dateMargin.toFixed(1)}%</td>
        </tr>
      `;
    });
    
    container.innerHTML = tableRows;
  }

  // –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
  function updateAnalytics() {
    showLoading(true);
    
    try {
      // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫–∏
      updateAnalyticsCharts();
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É —Ç–æ–ø-5 —Ç–æ–≤–∞—Ä–æ–≤
      updateTopProductsTable();
      
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:', error);
      showNotification('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏', 'error');
    }
    
    showLoading(false);
  }

  function updateAnalyticsCharts() {
    // –ì—Ä–∞—Ñ–∏–∫ –≤—ã—Ä—É—á–∫–∏ –∏ –ø—Ä–∏–±—ã–ª–∏
    const revenueCtx = document.getElementById('revenueChart').getContext('2d');
    
    if (revenueChart) {
      revenueChart.destroy();
    }
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π
    const days = Array.from({length: 30}, (_, i) => {
      const date = new Date();
      date.setDate(date.getDate() - (29 - i));
      return date.toLocaleDateString('ru-RU', { day: 'numeric', month: 'short' });
    });
    
    const revenueData = days.map(() => Math.floor(Math.random() * 80000) + 30000);
    const profitData = revenueData.map(revenue => Math.floor(revenue * (0.25 + Math.random() * 0.15)));
    const costData = revenueData.map((revenue, i) => revenue - profitData[i]);
    
    revenueChart = new Chart(revenueCtx, {
      type: 'bar',
      data: {
        labels: days,
        datasets: [
          {
            label: '–í—ã—Ä—É—á–∫–∞',
            data: revenueData,
            backgroundColor: 'rgba(255, 215, 0, 0.7)',
            borderColor: '#FFD700',
            borderWidth: 1
          },
          {
            label: '–ü—Ä–∏–±—ã–ª—å',
            data: profitData,
            backgroundColor: 'rgba(46, 204, 113, 0.7)',
            borderColor: '#2ecc71',
            borderWidth: 1
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            labels: {
              color: 'var(--admin-text)'
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            grid: {
              color: 'rgba(255, 255, 255, 0.05)'
            },
            ticks: {
              color: 'var(--admin-text-light)',
              callback: function(value) {
                return (value / 1000).toFixed(0) + 'k';
              }
            }
          },
          x: {
            grid: {
              color: 'rgba(255, 255, 255, 0.05)'
            },
            ticks: {
              color: 'var(--admin-text-light)',
              maxRotation: 45
            }
          }
        }
      }
    });
    
    // –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–¥–∞–∂ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    const categoryCtx = document.getElementById('categoryChart').getContext('2d');
    
    if (categoryChart) {
      categoryChart.destroy();
    }
    
    const categories = ['–û–±—É–≤—å', '–ú—É–∂—Å–∫–∞—è –æ–¥–µ–∂–¥–∞', '–ñ–µ–Ω—Å–∫–∞—è –æ–¥–µ–∂–¥–∞', '–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã', '–í–µ—Ä—Ö–Ω—è—è –æ–¥–µ–∂–¥–∞'];
    const categoryData = categories.map(() => Math.floor(Math.random() * 500000) + 200000);
    const categoryProfit = categoryData.map(revenue => Math.floor(revenue * (0.2 + Math.random() * 0.2)));
    
    categoryChart = new Chart(categoryCtx, {
      type: 'polarArea',
      data: {
        labels: categories,
        datasets: [{
          data: categoryData,
          backgroundColor: [
            'rgba(255, 99, 132, 0.7)',
            'rgba(54, 162, 235, 0.7)',
            'rgba(255, 206, 86, 0.7)',
            'rgba(75, 192, 192, 0.7)',
            'rgba(153, 102, 255, 0.7)'
          ],
          borderWidth: 2,
          borderColor: 'var(--admin-secondary)'
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'right',
            labels: {
              color: 'var(--admin-text)',
              padding: 20
            }
          }
        }
      }
    });
  }

  function updateTopProductsTable() {
    const container = document.getElementById('topProductsTable');
    const adminProducts = JSON.parse(localStorage.getItem('adminProducts')) || [];
    
    // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–æ–≤–∞—Ä—ã –ø–æ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏ (profit * –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å)
    const topProducts = adminProducts
      .map(product => {
        // –û—Ü–µ–Ω–∏–≤–∞–µ–º "–ø—Ä–æ–¥–∞–∂–∏" –∫–∞–∫ —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
        const sales = Math.floor(Math.random() * 100) + 10;
        const revenue = (product.price || 0) * sales;
        const profit = (product.profit || 0) * sales;
        const margin = product.margin || 0;
        
        return {
          name: product.name,
          sales: sales,
          revenue: revenue,
          profit: profit,
          margin: margin
        };
      })
      .sort((a, b) => b.profit - a.profit)
      .slice(0, 5);
    
    if (topProducts.length === 0) {
      container.innerHTML = `
        <tr>
          <td colspan="5" style="text-align: center; padding: 1rem; color: var(--admin-text-light);">
            –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö
          </td>
        </tr>
      `;
      return;
    }
    
    container.innerHTML = topProducts.map((product, index) => `
      <tr>
        <td><strong>${index + 1}. ${product.name}</strong></td>
        <td>${product.sales} —à—Ç.</td>
        <td>${formatCurrency(product.revenue)}</td>
        <td><span class="profit-badge profit-positive">${formatCurrency(product.profit)}</span></td>
        <td>${product.margin.toFixed(1)}%</td>
      </tr>
    `).join('');
  }

  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
  function loadSettings() {
    const settings = JSON.parse(localStorage.getItem('adminSettings')) || {};
    
    document.getElementById('shopName').value = settings.shopName || 'DROP SHOP –Ø–∫—É—Ç—Å–∫';
    document.getElementById('shopPhone').value = settings.shopPhone || '+7 (999) 123-45-67';
    document.getElementById('shopEmail').value = settings.shopEmail || 'info@dropshop-ykt.ru';
    document.getElementById('shopAddress').value = settings.shopAddress || '–Ø–∫—É—Ç—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, 15';
    document.getElementById('telegramToken').value = settings.telegramToken || '';
    document.getElementById('telegramChatId').value = settings.telegramChatId || '';
    
    document.getElementById('deliveryYakutsk').checked = settings.deliveryYakutsk !== false;
    document.getElementById('pickupAvailable').checked = settings.pickupAvailable !== false;
    document.getElementById('freeDelivery').checked = settings.freeDelivery !== false;
  }

  function saveSettings() {
    const settings = {
      shopName: document.getElementById('shopName').value,
      shopPhone: document.getElementById('shopPhone').value,
      shopEmail: document.getElementById('shopEmail').value,
      shopAddress: document.getElementById('shopAddress').value,
      telegramToken: document.getElementById('telegramToken').value,
      telegramChatId: document.getElementById('telegramChatId').value,
      deliveryYakutsk: document.getElementById('deliveryYakutsk').checked,
      pickupAvailable: document.getElementById('pickupAvailable').checked,
      freeDelivery: document.getElementById('freeDelivery').checked,
      updatedAt: new Date().toISOString()
    };
    
    localStorage.setItem('adminSettings', JSON.stringify(settings));
    showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
  }

  function resetSettings() {
    if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é?')) {
      localStorage.removeItem('adminSettings');
      loadSettings();
      showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã', 'info');
    }
  }

  // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
  function formatDate(dateString) {
    if (!dateString) return '–î–∞—Ç–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞';
    
    try {
      const date = new Date(dateString);
      return date.toLocaleDateString('ru-RU', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });
    } catch (e) {
      return dateString;
    }
  }

  function showCustomModal(title, content) {
    // –£–¥–∞–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
    document.querySelectorAll('.modal-backdrop, .custom-modal').forEach(el => el.remove());
    
    // –°–æ–∑–¥–∞–µ–º –æ–≤–µ—Ä–ª–µ–π
    const backdrop = document.createElement('div');
    backdrop.className = 'modal-backdrop';
    backdrop.style.cssText = `
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 9999;
    `;
    
    // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    const modal = document.createElement('div');
    modal.className = 'custom-modal';
    modal.style.cssText = `
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: var(--admin-secondary);
      border-radius: 15px;
      padding: 2rem;
      min-width: 400px;
      max-width: 90%;
      max-height: 90vh;
      overflow-y: auto;
      z-index: 10000;
      border: 1px solid rgba(255, 215, 0, 0.2);
    `;
    
    modal.innerHTML = `
      <div style="margin-bottom: 1.5rem;">
        <h3 style="font-size: 1.3rem; font-weight: 600; margin-bottom: 1rem; color: var(--admin-accent);">
          ${title}
        </h3>
        ${content}
      </div>
      <button onclick="this.closest('.custom-modal').remove(); this.closest('.modal-backdrop').remove();" 
              style="position: absolute; top: 1rem; right: 1rem; background: none; border: none; color: var(--admin-text-light); font-size: 1.5rem; cursor: pointer;">
        &times;
      </button>
    `;
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≤ DOM
    document.body.appendChild(backdrop);
    document.body.appendChild(modal);
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –Ω–∞ –æ–≤–µ—Ä–ª–µ–π
    backdrop.addEventListener('click', function() {
      backdrop.remove();
      modal.remove();
    });
  }

  // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  document.getElementById('productImages').addEventListener('input', function() {
    const urls = this.value.split(',').map(url => url.trim()).filter(url => url);
    const preview = document.getElementById('imagePreview');
    preview.innerHTML = '';
    
    urls.slice(0, 5).forEach(url => {
      const img = document.createElement('img');
      img.src = url;
      img.className = 'preview-image';
      img.onerror = function() {
        this.src = 'https://images.unsplash.com/photo-1560769629-975ec94e6a86?auto=format&fit=crop&w=200&h=150&q=80';
      };
      preview.appendChild(img);
    });
  });

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  document.addEventListener('DOMContentLoaded', function() {
    const isLoggedIn = localStorage.getItem('adminLoggedIn') === 'true';
    
    if (isLoggedIn) {
      const sessionData = localStorage.getItem('adminSession');
      if (sessionData) {
        try {
          const session = JSON.parse(atob(sessionData));
          const sessionAge = Date.now() - session.timestamp;
          
          if (sessionAge < 8 * 60 * 60 * 1000) {
            showAdminPanel();
            return;
          }
        } catch (e) {
          console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–µ—Å—Å–∏–∏:', e);
        }
      }
      
      logoutAdmin();
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ –º–∞—Ä–∂–∏
    calculateMargin();
  });
</script>
</body>
</html>