<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>DROP SHOP | –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  :root {
    --primary-black: #0a0a0a;
    --primary-white: #ffffff;
    --accent-gold: #FFD700;
    --accent-silver: #C0C0C0;
    --accent-red: #FF3B30;
    --bg-light: #f8f9fa;
    --bg-dark: #1a1a1a;
    --text-light: #666666;
    --success-green: #27ae60;
    --info-blue: #3498db;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background-color: var(--bg-light);
    color: var(--primary-black);
    line-height: 1.6;
  }

  /* Header (–∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π index.html) */
  .main-header {
    background: var(--primary-black);
    padding: 1rem 2rem;
    position: sticky;
    top: 0;
    width: 100%;
    z-index: 1000;
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  }

  .header-container {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 12px;
    text-decoration: none;
  }

  .logo-icon {
    font-size: 2.2rem;
    color: var(--accent-gold);
  }

  .logo-text {
    font-family: 'Helvetica Neue', sans-serif;
    font-weight: 900;
    font-size: 1.8rem;
    color: var(--primary-white);
    letter-spacing: -0.5px;
  }

  .logo-subtitle {
    font-size: 0.7rem;
    color: var(--accent-silver);
    margin-top: -5px;
    letter-spacing: 1.5px;
  }

  /* Checkout Container */
  .checkout-container {
    max-width: 1200px;
    margin: 2rem auto;
    padding: 0 2rem;
  }

  .checkout-title {
    font-size: 2.5rem;
    font-weight: 800;
    margin-bottom: 2rem;
    text-align: center;
  }

  .checkout-grid {
    display: grid;
    grid-template-columns: 1fr 400px;
    gap: 3rem;
  }

  @media (max-width: 992px) {
    .checkout-grid {
      grid-template-columns: 1fr;
    }
  }

  /* Checkout Steps */
  .checkout-steps {
    display: flex;
    justify-content: space-between;
    margin-bottom: 3rem;
    position: relative;
  }

  .checkout-steps::before {
    content: '';
    position: absolute;
    top: 20px;
    left: 0;
    right: 0;
    height: 2px;
    background: #e0e0e0;
    z-index: 1;
  }

  .step {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    z-index: 2;
  }

  .step-number {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: white;
    border: 2px solid #e0e0e0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    margin-bottom: 0.5rem;
    transition: all 0.3s ease;
  }

  .step.active .step-number {
    background: var(--accent-gold);
    border-color: var(--accent-gold);
    color: var(--primary-black);
  }

  .step.completed .step-number {
    background: var(--success-green);
    border-color: var(--success-green);
    color: white;
  }

  .step-label {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text-light);
  }

  .step.active .step-label {
    color: var(--primary-black);
  }

  /* Checkout Form */
  .checkout-form {
    background: white;
    border-radius: 15px;
    padding: 2rem;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  }

  .form-section {
    margin-bottom: 2.5rem;
    padding-bottom: 2rem;
    border-bottom: 1px solid #f0f0f0;
  }

  .section-title {
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    display: flex;
    align-items: center;
    gap: 0.8rem;
  }

  .section-title i {
    color: var(--accent-gold);
  }

  .form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
  }

  .form-group {
    margin-bottom: 1.5rem;
  }

  .form-label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    font-size: 0.9rem;
  }

  .form-input {
    width: 100%;
    padding: 1rem;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 1rem;
    transition: all 0.3s ease;
  }

  .form-input:focus {
    outline: none;
    border-color: var(--accent-gold);
    box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.1);
  }

  .form-select {
    width: 100%;
    padding: 1rem;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 1rem;
    background: white;
    cursor: pointer;
  }

  textarea.form-input {
    min-height: 100px;
    resize: vertical;
    font-family: inherit;
  }

  /* Payment Methods */
  .payment-methods {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
  }

  .payment-method {
    padding: 1.5rem;
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    text-align: center;
  }

  .payment-method:hover {
    border-color: var(--accent-gold);
  }

  .payment-method.selected {
    border-color: var(--accent-gold);
    background: rgba(255, 215, 0, 0.05);
  }

  .payment-icon {
    font-size: 2rem;
    margin-bottom: 0.8rem;
    color: var(--text-light);
  }

  .payment-method.selected .payment-icon {
    color: var(--accent-gold);
  }

  /* Order Summary */
  .order-summary {
    background: white;
    border-radius: 15px;
    padding: 2rem;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    position: sticky;
    top: 100px;
  }

  .summary-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid var(--bg-light);
  }

  .summary-items {
    max-height: 300px;
    overflow-y: auto;
    margin-bottom: 1.5rem;
  }

  .summary-item {
    display: flex;
    justify-content: space-between;
    padding: 1rem 0;
    border-bottom: 1px solid #f0f0f0;
  }

  .item-info {
    flex: 1;
  }

  .item-name {
    font-weight: 600;
    margin-bottom: 0.3rem;
  }

  .item-details {
    font-size: 0.9rem;
    color: var(--text-light);
  }

  .item-price {
    font-weight: 700;
    white-space: nowrap;
    margin-left: 1rem;
  }

  .summary-totals {
    margin-top: 1.5rem;
    padding-top: 1.5rem;
    border-top: 2px solid var(--bg-light);
  }

  .total-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 1rem;
    font-size: 1.1rem;
  }

  .total-row.grand-total {
    font-size: 1.5rem;
    font-weight: 800;
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 2px solid var(--bg-light);
  }

  .delivery-info {
    background: rgba(52, 152, 219, 0.1);
    padding: 1rem;
    border-radius: 8px;
    margin: 1.5rem 0;
    font-size: 0.9rem;
    color: var(--info-blue);
  }

  /* Submit Button */
  .submit-btn {
    width: 100%;
    padding: 1.2rem;
    background: var(--accent-gold);
    color: var(--primary-black);
    border: none;
    border-radius: 12px;
    font-size: 1.1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.8rem;
    margin-top: 1.5rem;
  }

  .submit-btn:hover:not(:disabled) {
    background: #ffed4e;
    transform: translateY(-2px);
  }

  .submit-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  /* Loading */
  .loading {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.9);
    z-index: 10000;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    gap: 1.5rem;
  }

  .spinner {
    width: 60px;
    height: 60px;
    border: 5px solid #f3f3f3;
    border-top: 5px solid var(--accent-gold);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* Success Modal */
  .success-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 10000;
    justify-content: center;
    align-items: center;
    padding: 2rem;
  }

  .modal-content {
    background: white;
    border-radius: 20px;
    padding: 3rem;
    max-width: 500px;
    width: 100%;
    text-align: center;
    animation: modalIn 0.5s ease;
  }

  @keyframes modalIn {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .modal-icon {
    font-size: 4rem;
    color: var(--success-green);
    margin-bottom: 1.5rem;
  }

  .modal-title {
    font-size: 2rem;
    font-weight: 800;
    margin-bottom: 1rem;
  }

  .modal-text {
    color: var(--text-light);
    margin-bottom: 2rem;
    line-height: 1.6;
  }

  /* Error Messages */
  .error-message {
    background: rgba(255, 59, 48, 0.1);
    color: var(--accent-red);
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1.5rem;
    border: 1px solid rgba(255, 59, 48, 0.2);
    display: none;
  }

  /* Footer */
  .main-footer {
    background: var(--primary-black);
    color: var(--primary-white);
    padding: 4rem 2rem 2rem;
    margin-top: 4rem;
  }
</style>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>
<body>

<!-- Header -->
<header class="main-header">
  <div class="header-container">
    <a href="index.html" class="logo">
      <div class="logo-icon">üëë</div>
      <div>
        <div class="logo-text">DROP SHOP</div>
        <div class="logo-subtitle">–Ø–ö–£–¢–°–ö | –û–†–ò–ì–ò–ù–ê–õ–´ & –†–ï–ü–õ–ò–ö–ò</div>
      </div>
    </a>

    <nav class="main-nav">
      <a href="index.html" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
      <a href="catalog.html" class="nav-link">–ö–∞—Ç–∞–ª–æ–≥</a>
      <a href="about.html" class="nav-link">–û –Ω–∞—Å</a>
      <a href="contact.html" class="nav-link">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
    </nav>

    <div class="header-actions">
      <button class="action-btn" onclick="window.location.href='cart.html'">
        <i class="fas fa-shopping-bag"></i>
        <span class="badge cart-badge" id="cartCount">0</span>
      </button>
    </div>
  </div>
</header>

<!-- Checkout Steps -->
<div class="checkout-container">
  <h1 class="checkout-title">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h1>
  
  <div class="checkout-steps">
    <div class="step active" id="step1">
      <div class="step-number">1</div>
      <div class="step-label">–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</div>
    </div>
    <div class="step" id="step2">
      <div class="step-number">2</div>
      <div class="step-label">–î–æ—Å—Ç–∞–≤–∫–∞</div>
    </div>
    <div class="step" id="step3">
      <div class="step-number">3</div>
      <div class="step-label">–û–ø–ª–∞—Ç–∞</div>
    </div>
    <div class="step" id="step4">
      <div class="step-number">4</div>
      <div class="step-label">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
    </div>
  </div>

  <div class="checkout-grid">
    <!-- Checkout Form -->
    <div class="checkout-form">
      <div class="error-message" id="errorMessage"></div>
      
      <form id="checkoutForm">
        <!-- –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ -->
        <div class="form-section" id="contactSection">
          <h3 class="section-title">
            <i class="fas fa-user"></i>
            –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
          </h3>
          
          <div class="form-grid">
            <div class="form-group">
              <label class="form-label">–ò–º—è –∏ –§–∞–º–∏–ª–∏—è *</label>
              <input type="text" class="form-input" id="fullName" required>
            </div>
            
            <div class="form-group">
              <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
              <input type="tel" class="form-input" id="phone" required placeholder="+7 (999) 123-45-67">
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Email</label>
            <input type="email" class="form-input" id="email" placeholder="example@mail.ru">
          </div>
          
          <div class="form-group">
            <label class="form-label">Telegram (–¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Å–≤—è–∑–∏)</label>
            <input type="text" class="form-input" id="telegram" placeholder="@username">
          </div>
        </div>

        <!-- –î–æ—Å—Ç–∞–≤–∫–∞ -->
        <div class="form-section" id="deliverySection">
          <h3 class="section-title">
            <i class="fas fa-truck"></i>
            –î–æ—Å—Ç–∞–≤–∫–∞
          </h3>
          
          <div class="form-group">
            <label class="form-label">–ì–æ—Ä–æ–¥ *</label>
            <input type="text" class="form-input" id="city" value="–Ø–∫—É—Ç—Å–∫" required>
          </div>
          
          <div class="form-group">
            <label class="form-label">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
            <input type="text" class="form-input" id="address" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞" required>
          </div>
          
          <div class="form-group">
            <label class="form-label">–°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
            <select class="form-select" id="deliveryMethod" required>
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–±</option>
              <option value="courier">–ö—É—Ä—å–µ—Ä—Å–∫–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ (300 ‚ÇΩ)</option>
              <option value="pickup">–°–∞–º–æ–≤—ã–≤–æ–∑ (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)</option>
              <option value="express">–≠–∫—Å–ø—Ä–µ—Å—Å –¥–æ—Å—Ç–∞–≤–∫–∞ (500 ‚ÇΩ, 2-3 —á–∞—Å–∞)</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –¥–æ—Å—Ç–∞–≤–∫–µ</label>
            <textarea class="form-input" id="deliveryComment" placeholder="–ü–æ–¥—ä–µ–∑–¥, –∫–æ–¥ –¥–æ–º–æ—Ñ–æ–Ω–∞, —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è"></textarea>
          </div>
        </div>

        <!-- –û–ø–ª–∞—Ç–∞ -->
        <div class="form-section" id="paymentSection">
          <h3 class="section-title">
            <i class="fas fa-credit-card"></i>
            –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
          </h3>
          
          <div class="payment-methods">
            <div class="payment-method" onclick="selectPayment('cash')">
              <div class="payment-icon">üíµ</div>
              <div>–ù–∞–ª–∏—á–Ω—ã–º–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</div>
            </div>
            
            <div class="payment-method" onclick="selectPayment('card')">
              <div class="payment-icon">üí≥</div>
              <div>–ö–∞—Ä—Ç–æ–π –æ–Ω–ª–∞–π–Ω</div>
            </div>
            
            <div class="payment-method" onclick="selectPayment('transfer')">
              <div class="payment-icon">üè¶</div>
              <div>–ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∫–∞—Ä—Ç—É</div>
            </div>
            
            <div class="payment-method" onclick="selectPayment('sber')">
              <div class="payment-icon">ü§ñ</div>
              <div>–°–±–µ—Ä–ü–µ–π</div>
            </div>
          </div>
          
          <input type="hidden" id="paymentMethod" required>
          
          <div class="form-group" id="paymentDetails" style="display: none;">
            <label class="form-label">–î–µ—Ç–∞–ª–∏ –æ–ø–ª–∞—Ç—ã</label>
            <textarea class="form-input" id="paymentComment" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –æ–ø–ª–∞—Ç–µ"></textarea>
          </div>
        </div>

        <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É -->
        <div class="form-section">
          <h3 class="section-title">
            <i class="fas fa-comment"></i>
            –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É
          </h3>
          
          <div class="form-group">
            <textarea class="form-input" id="orderComment" placeholder="–í–∞—à–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è, –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –æ—Å–æ–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∑–∞–∫–∞–∑—É"></textarea>
          </div>
        </div>
        
        <button type="submit" class="submit-btn" id="submitBtn">
          <i class="fas fa-lock"></i>
          –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑
        </button>
      </form>
    </div>

    <!-- Order Summary -->
    <div class="order-summary" id="orderSummary">
      <!-- Summary loaded by JavaScript -->
    </div>
  </div>
</div>

<!-- Loading Overlay -->
<div class="loading" id="loading">
  <div class="spinner"></div>
  <div>–û—Ñ–æ—Ä–º–ª—è–µ–º –≤–∞—à –∑–∞–∫–∞–∑...</div>
</div>

<!-- Success Modal -->
<div class="success-modal" id="successModal">
  <div class="modal-content">
    <div class="modal-icon">‚úÖ</div>
    <h2 class="modal-title">–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!</h2>
    <div class="modal-text" id="successMessage">
      –í–∞—à –∑–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω. –ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞: <strong id="orderNumber">0000</strong><br><br>
      –ú–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 15 –º–∏–Ω—É—Ç –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.
    </div>
    <button class="submit-btn" onclick="closeSuccessModal()">
      <i class="fas fa-home"></i>
      –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é
    </button>
  </div>
</div>

<!-- Footer -->
<footer class="main-footer">
  <div class="footer-content">
    <div class="footer-column">
      <h3>DROP SHOP –Ø–ö–£–¢–°–ö</h3>
      <p style="color: var(--accent-silver); margin-bottom: 1.5rem;">–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω –≤ –Ø–∫—É—Ç—Å–∫–µ —Å –æ—Ä–∏–≥–∏–Ω–∞–ª–∞–º–∏ –ø–æ–¥ –∑–∞–∫–∞–∑ –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Ä–µ–ø–ª–∏–∫–∞–º–∏ –≤ –Ω–∞–ª–∏—á–∏–∏.</p>
    </div>
    
    <div class="footer-column">
      <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
      <ul>
        <li><i class="fas fa-map-marker-alt"></i> –Ø–∫—É—Ç—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, 15</li>
        <li><i class="fas fa-phone"></i> +7 (999) 123-45-67</li>
        <li><i class="fas fa-envelope"></i> info@dropshop-ykt.ru</li>
      </ul>
    </div>
    
    <div class="footer-column">
      <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
      <ul>
        <li><a href="delivery.html">–î–æ—Å—Ç–∞–≤–∫–∞ –∏ –æ–ø–ª–∞—Ç–∞</a></li>
        <li><a href="guarantee.html">–ì–∞—Ä–∞–Ω—Ç–∏—è</a></li>
        <li><a href="return.html">–í–æ–∑–≤—Ä–∞—Ç</a></li>
        <li><a href="admin.html" style="color: var(--accent-gold);"><i class="fas fa-lock"></i> –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</a></li>
      </ul>
    </div>
  </div>
  
  <div class="copyright">
    <p>¬© 2024 DROP SHOP –Ø–∫—É—Ç—Å–∫. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
  </div>
</footer>

<script>
  // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Telegram –±–æ—Ç–∞
  const TELEGRAM_CONFIG = {
    botToken: '8505187955:AAFAQpSiQ7nodKJ0ILwo0A3PJLM4llUqV4Y',
    chatId: '6478016631',
    enabled: true
  };

  // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
  let cart = {};
  let selectedPayment = '';
  let currentStep = 1;

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤
  function updateCounters() {
    cart = JSON.parse(localStorage.getItem('cart')) || {};
    const cartCount = Object.values(cart).reduce((sum, item) => sum + (item.quantity || 1), 0);
    document.getElementById('cartCount').textContent = cartCount > 99 ? '99+' : cartCount;
  }

  // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–æ–¥–∫–∏ –∑–∞–∫–∞–∑–∞
  function loadOrderSummary() {
    cart = JSON.parse(localStorage.getItem('cart')) || {};
    const container = document.getElementById('orderSummary');
    
    if (Object.keys(cart).length === 0) {
      container.innerHTML = `
        <div style="text-align: center; padding: 2rem;">
          <div style="font-size: 3rem; margin-bottom: 1rem;">üõí</div>
          <p style="margin-bottom: 1.5rem;">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
          <a href="catalog.html" style="display: inline-block; padding: 0.8rem 1.5rem; background: var(--accent-gold); color: var(--primary-black); border-radius: 8px; text-decoration: none; font-weight: 600;">
            –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥
          </a>
        </div>
      `;
      document.getElementById('submitBtn').disabled = true;
      return;
    }
    
    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∏—Ç–æ–≥–∏
    const cartItems = Object.values(cart);
    let subtotal = 0;
    let replicaCount = 0;
    let originalCount = 0;
    
    cartItems.forEach(item => {
      const itemTotal = item.price * (item.quantity || 1);
      subtotal += itemTotal;
      if (item.type === 'original') {
        originalCount += (item.quantity || 1);
      } else {
        replicaCount += (item.quantity || 1);
      }
    });
    
    // –î–æ—Å—Ç–∞–≤–∫–∞
    const deliveryMethod = document.getElementById('deliveryMethod')?.value || 'courier';
    const deliveryCost = deliveryMethod === 'pickup' ? 0 : deliveryMethod === 'express' ? 500 : 300;
    const freeDelivery = subtotal >= 5000;
    const delivery = freeDelivery ? 0 : deliveryCost;
    
    const total = subtotal + delivery;
    
    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–æ–≤–∞—Ä—ã
    let itemsHTML = '';
    cartItems.slice(0, 5).forEach((item, index) => {
      const itemTotal = item.price * (item.quantity || 1);
      itemsHTML += `
        <div class="summary-item">
          <div class="item-info">
            <div class="item-name">${item.name}</div>
            <div class="item-details">
              ${item.type === 'original' ? '–û—Ä–∏–≥–∏–Ω–∞–ª' : '–†–µ–ø–ª–∏–∫–∞'} ‚Ä¢ ${item.size || '–ë–µ–∑ —Ä–∞–∑–º–µ—Ä–∞'} ‚Ä¢ ${item.quantity || 1} —à—Ç.
            </div>
          </div>
          <div class="item-price">${itemTotal.toLocaleString()} ‚ÇΩ</div>
        </div>
      `;
    });
    
    if (cartItems.length > 5) {
      itemsHTML += `
        <div class="summary-item" style="text-align: center; color: var(--text-light);">
          –∏ –µ—â–µ ${cartItems.length - 5} —Ç–æ–≤–∞—Ä(–æ–≤)
        </div>
      `;
    }
    
    container.innerHTML = `
      <h3 class="summary-title">–í–∞—à –∑–∞–∫–∞–∑</h3>
      
      <div class="summary-items">
        ${itemsHTML}
      </div>
      
      <div class="summary-totals">
        <div class="total-row">
          <span>–¢–æ–≤–∞—Ä—ã (${cartItems.length} —à—Ç.)</span>
          <span>${subtotal.toLocaleString()} ‚ÇΩ</span>
        </div>
        
        <div class="total-row">
          <span>–î–æ—Å—Ç–∞–≤–∫–∞</span>
          <span>${delivery === 0 ? '–ë–µ—Å–ø–ª–∞—Ç–Ω–æ' : `${delivery.toLocaleString()} ‚ÇΩ`}</span>
        </div>
        
        ${freeDelivery ? '' : `
          <div style="font-size: 0.9rem; color: var(--success-green); text-align: right; margin-top: 0.5rem;">
            –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –æ—Ç 5 000 ‚ÇΩ
          </div>
        `}
        
        <div class="total-row grand-total">
          <span>–ò—Ç–æ–≥–æ</span>
          <span>${total.toLocaleString()} ‚ÇΩ</span>
        </div>
      </div>
      
      ${originalCount > 0 ? `
        <div class="delivery-info">
          <i class="fas fa-info-circle"></i>
          –í –≤–∞—à–µ–º –∑–∞–∫–∞–∑–µ ${originalCount} –æ—Ä–∏–≥–∏–Ω–∞–ª(–∞) –ø–æ–¥ –∑–∞–∫–∞–∑. –°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ 7-14 –¥–Ω–µ–π.
        </div>
      ` : ''}
      
      <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid #f0f0f0;">
        <div style="display: flex; align-items: center; gap: 0.8rem; color: var(--text-light); font-size: 0.9rem;">
          <i class="fas fa-shield-alt"></i>
          <span>–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–ª–∞—Ç–∞ ‚Ä¢ –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</span>
        </div>
      </div>
    `;
  }

  // –í—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã
  function selectPayment(method) {
    selectedPayment = method;
    document.getElementById('paymentMethod').value = method;
    
    // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö —Å–ø–æ—Å–æ–±–æ–≤
    document.querySelectorAll('.payment-method').forEach(el => {
      el.classList.remove('selected');
    });
    
    // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π
    event.target.closest('.payment-method').classList.add('selected');
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    const detailsDiv = document.getElementById('paymentDetails');
    if (method === 'transfer' || method === 'sber') {
      detailsDiv.style.display = 'block';
      document.getElementById('paymentComment').placeholder = 
        method === 'transfer' ? '–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞' : '–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è –°–±–µ—Ä–ü–µ–π';
    } else {
      detailsDiv.style.display = 'none';
    }
    
    // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É
    setStep(3);
  }

  // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞
  function setStep(stepNumber) {
    currentStep = stepNumber;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —à–∞–≥–æ–≤
    for (let i = 1; i <= 4; i++) {
      const stepEl = document.getElementById(`step${i}`);
      if (i < stepNumber) {
        stepEl.classList.remove('active');
        stepEl.classList.add('completed');
      } else if (i === stepNumber) {
        stepEl.classList.add('active');
        stepEl.classList.remove('completed');
      } else {
        stepEl.classList.remove('active', 'completed');
      }
    }
    
    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Å–µ–∫—Ü–∏–∏
    const sections = ['contactSection', 'deliverySection', 'paymentSection'];
    if (stepNumber <= 3) {
      document.getElementById(sections[stepNumber - 1]).scrollIntoView({
        behavior: 'smooth',
        block: 'start'
      });
    }
  }

  // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
  function validateForm() {
    const fullName = document.getElementById('fullName').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const city = document.getElementById('city').value.trim();
    const address = document.getElementById('address').value.trim();
    const deliveryMethod = document.getElementById('deliveryMethod').value;
    const paymentMethod = document.getElementById('paymentMethod').value;
    
    const errorDiv = document.getElementById('errorMessage');
    errorDiv.style.display = 'none';
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
    if (!fullName || !phone || !city || !address || !deliveryMethod || !paymentMethod) {
      showError('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (–ø–æ–º–µ—á–µ–Ω—ã *)');
      return false;
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    const phoneRegex = /^(\+7|8)[\s\-]?\(?\d{3}\)?[\s\-]?\d{3}[\s\-]?\d{2}[\s\-]?\d{2}$/;
    if (!phoneRegex.test(phone.replace(/\s/g, ''))) {
      showError('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞');
      return false;
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ email –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω
    const email = document.getElementById('email').value.trim();
    if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
      showError('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email –∞–¥—Ä–µ—Å');
      return false;
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
    if (Object.keys(cart).length === 0) {
      showError('–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞');
      return false;
    }
    
    return true;
  }

  // –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É
  function showError(message) {
    const errorDiv = document.getElementById('errorMessage');
    errorDiv.textContent = message;
    errorDiv.style.display = 'block';
    errorDiv.scrollIntoView({ behavior: 'smooth' });
  }

  // –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞
  async function submitOrder(event) {
    event.preventDefault();
    
    if (!validateForm()) {
      return false;
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
    document.getElementById('loading').style.display = 'flex';
    document.getElementById('submitBtn').disabled = true;
    
    try {
      // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞
      const orderData = {
        id: 'DROP-' + Date.now().toString().slice(-6),
        date: new Date().toLocaleString('ru-RU'),
        fullName: document.getElementById('fullName').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        email: document.getElementById('email').value.trim() || '–ù–µ —É–∫–∞–∑–∞–Ω',
        telegram: document.getElementById('telegram').value.trim() || '–ù–µ —É–∫–∞–∑–∞–Ω',
        city: document.getElementById('city').value.trim(),
        address: document.getElementById('address').value.trim(),
        deliveryMethod: document.getElementById('deliveryMethod').value,
        deliveryComment: document.getElementById('deliveryComment').value.trim() || '–ù–µ—Ç',
        paymentMethod: document.getElementById('paymentMethod').value,
        paymentComment: document.getElementById('paymentComment').value.trim() || '–ù–µ—Ç',
        orderComment: document.getElementById('orderComment').value.trim() || '–ù–µ—Ç',
        items: Object.values(cart).map(item => ({
          name: item.name,
          type: item.type,
          price: item.price,
          quantity: item.quantity || 1,
          size: item.size,
          total: item.price * (item.quantity || 1)
        })),
        totals: calculateTotals()
      };
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–∫–∞–∑ –≤ localStorage
      const orders = JSON.parse(localStorage.getItem('orders')) || [];
      orders.push(orderData);
      localStorage.setItem('orders', JSON.stringify(orders));
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
      const telegramSent = await sendToTelegram(orderData);
      
      // –û—á–∏—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É
      localStorage.removeItem('cart');
      cart = {};
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
      document.getElementById('loading').style.display = 'none';
      document.getElementById('orderNumber').textContent = orderData.id;
      
      if (telegramSent) {
        document.getElementById('successMessage').innerHTML = `
          –í–∞—à –∑–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω!<br>
          <strong>–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞: ${orderData.id}</strong><br><br>
          ‚úÖ –ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –º–µ–Ω–µ–¥–∂–µ—Ä—É<br>
          üìû –í–∞–º —Å–∫–æ—Ä–æ –ø–æ–∑–≤–æ–Ω—è—Ç –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è<br>
          üöö ${orderData.deliveryMethod === 'express' ? '–î–æ—Å—Ç–∞–≤–∫–∞ —Å–µ–≥–æ–¥–Ω—è' : '–î–æ—Å—Ç–∞–≤–∫–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 1-2 –¥–Ω–µ–π'}
        `;
      } else {
        document.getElementById('successMessage').innerHTML = `
          –í–∞—à –∑–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!<br>
          <strong>–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞: ${orderData.id}</strong><br><br>
          ‚ö†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ<br>
          üìû –ú–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –º–∏–Ω—É—Ç<br>
          üìß –ó–∞–∫–∞–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ
        `;
      }
      
      document.getElementById('successModal').style.display = 'flex';
      
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞:', error);
      document.getElementById('loading').style.display = 'none';
      document.getElementById('submitBtn').disabled = false;
      showError('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.');
    }
    
    return false;
  }

  // –†–∞—Å—á–µ—Ç –∏—Ç–æ–≥–æ–≤
  function calculateTotals() {
    const cartItems = Object.values(cart);
    let subtotal = 0;
    let replicaCount = 0;
    let originalCount = 0;
    
    cartItems.forEach(item => {
      const itemTotal = item.price * (item.quantity || 1);
      subtotal += itemTotal;
      if (item.type === 'original') {
        originalCount += (item.quantity || 1);
      } else {
        replicaCount += (item.quantity || 1);
      }
    });
    
    const deliveryMethod = document.getElementById('deliveryMethod')?.value || 'courier';
    const deliveryCost = deliveryMethod === 'pickup' ? 0 : deliveryMethod === 'express' ? 500 : 300;
    const freeDelivery = subtotal >= 5000;
    const delivery = freeDelivery ? 0 : deliveryCost;
    
    return {
      subtotal,
      delivery,
      total: subtotal + delivery,
      replicaCount,
      originalCount,
      freeDelivery
    };
  }

  // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram
  async function sendToTelegram(orderData) {
    if (!TELEGRAM_CONFIG.enabled) {
      console.log('Telegram –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞');
      return true;
    }
    
    try {
      const totals = orderData.totals;
      
      // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
      const message = `
üõí *–ù–û–í–´–ô –ó–ê–ö–ê–ó DROP SHOP #${orderData.id}*

*üë§ –ö–õ–ò–ï–ù–¢:*
${orderData.fullName}
üìû ${orderData.phone}
üìß ${orderData.email}
‚úàÔ∏è ${orderData.telegram}

*üìç –ê–î–†–ï–°:*
${orderData.city}, ${orderData.address}

*üöö –î–û–°–¢–ê–í–ö–ê:*
${getDeliveryText(orderData.deliveryMethod)}
üí¨ ${orderData.deliveryComment}

*üí≥ –û–ü–õ–ê–¢–ê:*
${getPaymentText(orderData.paymentMethod)}
üí¨ ${orderData.paymentComment}

*üì¶ –ó–ê–ö–ê–ó:*
${orderData.items.map((item, i) => 
  `${i+1}. ${item.name}
   ${item.type === 'original' ? 'üëë –û–†–ò–ì–ò–ù–ê–õ' : 'üîÅ –†–ï–ü–õ–ò–ö–ê'} ‚Ä¢ ${item.size || '-'} ‚Ä¢ ${item.quantity} —à—Ç.
   ${item.price.toLocaleString()} ‚ÇΩ √ó ${item.quantity} = ${item.total.toLocaleString()} ‚ÇΩ`
).join('\n\n')}

*üí∞ –ò–¢–û–ì–û:*
–¢–æ–≤–∞—Ä—ã: ${totals.subtotal.toLocaleString()} ‚ÇΩ
–î–æ—Å—Ç–∞–≤–∫–∞: ${totals.delivery === 0 ? '–ë–µ—Å–ø–ª–∞—Ç–Ω–æ' : totals.delivery.toLocaleString() + ' ‚ÇΩ'}
*–í–°–ï–ì–û: ${totals.total.toLocaleString()} ‚ÇΩ*

${totals.originalCount > 0 ? `üëë –û—Ä–∏–≥–∏–Ω–∞–ª–æ–≤: ${totals.originalCount} —à—Ç. (–¥–æ—Å—Ç–∞–≤–∫–∞ 7-14 –¥–Ω–µ–π)` : ''}
${totals.replicaCount > 0 ? `üîÅ –†–µ–ø–ª–∏–∫: ${totals.replicaCount} —à—Ç. (–≤ –Ω–∞–ª–∏—á–∏–∏)` : ''}

*üí¨ –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô:*
${orderData.orderComment}

‚è∞ ${orderData.date}
`.trim();

      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
      const response = await fetch(`https://api.telegram.org/bot${TELEGRAM_CONFIG.botToken}/sendMessage`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          chat_id: TELEGRAM_CONFIG.chatId,
          text: message,
          parse_mode: 'Markdown'
        })
      });

      const data = await response.json();
      return data.ok;

    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram:', error);
      return false;
    }
  }

  // –¢–µ–∫—Å—Ç –¥–æ—Å—Ç–∞–≤–∫–∏
  function getDeliveryText(method) {
    switch(method) {
      case 'courier': return '–ö—É—Ä—å–µ—Ä—Å–∫–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ (300 ‚ÇΩ)';
      case 'pickup': return '–°–∞–º–æ–≤—ã–≤–æ–∑ (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)';
      case 'express': return '–≠–∫—Å–ø—Ä–µ—Å—Å –¥–æ—Å—Ç–∞–≤–∫–∞ (500 ‚ÇΩ, 2-3 —á–∞—Å–∞)';
      default: return method;
    }
  }

  // –¢–µ–∫—Å—Ç –æ–ø–ª–∞—Ç—ã
  function getPaymentText(method) {
    switch(method) {
      case 'cash': return '–ù–∞–ª–∏—á–Ω—ã–º–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏';
      case 'card': return '–ö–∞—Ä—Ç–æ–π –æ–Ω–ª–∞–π–Ω';
      case 'transfer': return '–ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∫–∞—Ä—Ç—É';
      case 'sber': return '–°–±–µ—Ä–ü–µ–π';
      default: return method;
    }
  }

  // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
  function closeSuccessModal() {
    document.getElementById('successModal').style.display = 'none';
    window.location.href = 'index.html';
  }

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
  document.getElementById('deliveryMethod')?.addEventListener('change', function() {
    loadOrderSummary();
    setStep(2);
  });

  // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
  document.getElementById('phone')?.addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.startsWith('7') || value.startsWith('8')) {
      value = '+7' + value.substring(1);
    } else if (value.length > 0 && !value.startsWith('+')) {
      value = '+' + value;
    }
    
    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∫–∞–∫ +7 (999) 123-45-67
    if (value.length > 2) {
      value = value.substring(0, 2) + ' ' + value.substring(2);
    }
    if (value.length > 6) {
      value = value.substring(0, 6) + ' ' + value.substring(6);
    }
    if (value.length > 10) {
      value = value.substring(0, 10) + '-' + value.substring(10);
    }
    if (value.length > 13) {
      value = value.substring(0, 13) + '-' + value.substring(13);
    }
    
    e.target.value = value.substring(0, 16);
  });

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  document.addEventListener('DOMContentLoaded', function() {
    updateCounters();
    loadOrderSummary();
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã
    document.getElementById('checkoutForm').addEventListener('submit', submitOrder);
    
    // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–µ—Ä–≤–æ–º –ø–æ–ª–µ
    document.getElementById('fullName').focus();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–≤–æ–¥–∫—É –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–ø–æ—Å–æ–±–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
    const deliverySelect = document.getElementById('deliveryMethod');
    if (deliverySelect) {
      deliverySelect.addEventListener('change', loadOrderSummary);
    }
  });
</script>
</body>
</html>